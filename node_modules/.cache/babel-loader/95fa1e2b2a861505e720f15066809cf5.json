{"ast":null,"code":"import jwtDecode from \"jwt-decode\";\nimport https from \"./httpService\";\nimport { apiUrl, admin, user, name } from \"../config.json\";\nimport { openNotification } from \"../components/custom\";\nexport function login(values, history) {\n  return https.post(apiUrl + \"user/login\", values).then(res => {\n    localStorage.setItem(admin, res.data.admin);\n    localStorage.setItem(user, res.data.user);\n    localStorage.setItem(name, res.data.data);\n\n    if (res.data.status === 200) {\n      history.replace(\"/admin\");\n      openNotification(\"success\", `${res.data.data} Successfully logged in`);\n    } else if (res.data.status === 302) {\n      history.replace(\"/user\");\n      openNotification(\"success\", `${res.data.data} Successfully logged in`);\n    } else if (res.data.status === 401) {\n      return openNotification(\"error\", \"Email or Password is not valid\", \"Please retype Email or Password\");\n    } else if (res.data.status === 404) {\n      return openNotification(\"error\", \"Email or Password is not valid\", \"Please retype Email or Password\");\n    }\n  });\n}\nexport function getAdmin() {\n  try {\n    const jwt = localStorage.getItem(admin);\n    return jwtDecode(jwt);\n  } catch (error) {\n    return null;\n  }\n}\nexport function getUser() {\n  try {\n    const jwt = localStorage.getItem(user);\n    return jwtDecode(jwt);\n  } catch (error) {\n    return null;\n  }\n}","map":{"version":3,"sources":["/Users/abdurauf/Desktop/毕业设计/orginal/restaurant-management-system/plov/src/services/auth.js"],"names":["jwtDecode","https","apiUrl","admin","user","name","openNotification","login","values","history","post","then","res","localStorage","setItem","data","status","replace","getAdmin","jwt","getItem","error","getUser"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,OAAOC,KAAP,MAAkB,eAAlB;AACA,SAASC,MAAT,EAAiBC,KAAjB,EAAwBC,IAAxB,EAA8BC,IAA9B,QAA0C,gBAA1C;AACA,SAASC,gBAAT,QAAiC,sBAAjC;AAEA,OAAO,SAASC,KAAT,CAAeC,MAAf,EAAuBC,OAAvB,EAAgC;AACrC,SAAOR,KAAK,CAACS,IAAN,CAAWR,MAAM,GAAG,YAApB,EAAkCM,MAAlC,EAA0CG,IAA1C,CAA+CC,GAAG,IAAI;AAC3DC,IAAAA,YAAY,CAACC,OAAb,CAAqBX,KAArB,EAA4BS,GAAG,CAACG,IAAJ,CAASZ,KAArC;AACAU,IAAAA,YAAY,CAACC,OAAb,CAAqBV,IAArB,EAA2BQ,GAAG,CAACG,IAAJ,CAASX,IAApC;AACAS,IAAAA,YAAY,CAACC,OAAb,CAAqBT,IAArB,EAA2BO,GAAG,CAACG,IAAJ,CAASA,IAApC;;AACA,QAAIH,GAAG,CAACG,IAAJ,CAASC,MAAT,KAAoB,GAAxB,EAA6B;AAC3BP,MAAAA,OAAO,CAACQ,OAAR,CAAgB,QAAhB;AACAX,MAAAA,gBAAgB,CAAC,SAAD,EAAa,GAAEM,GAAG,CAACG,IAAJ,CAASA,IAAK,yBAA7B,CAAhB;AACD,KAHD,MAGO,IAAIH,GAAG,CAACG,IAAJ,CAASC,MAAT,KAAoB,GAAxB,EAA6B;AAClCP,MAAAA,OAAO,CAACQ,OAAR,CAAgB,OAAhB;AACAX,MAAAA,gBAAgB,CAAC,SAAD,EAAa,GAAEM,GAAG,CAACG,IAAJ,CAASA,IAAK,yBAA7B,CAAhB;AACD,KAHM,MAGA,IAAIH,GAAG,CAACG,IAAJ,CAASC,MAAT,KAAoB,GAAxB,EAA6B;AAClC,aAAOV,gBAAgB,CACrB,OADqB,EAErB,gCAFqB,EAGrB,iCAHqB,CAAvB;AAKD,KANM,MAMA,IAAIM,GAAG,CAACG,IAAJ,CAASC,MAAT,KAAoB,GAAxB,EAA6B;AAClC,aAAOV,gBAAgB,CACrB,OADqB,EAErB,gCAFqB,EAGrB,iCAHqB,CAAvB;AAKD;AACF,GAvBM,CAAP;AAwBD;AAED,OAAO,SAASY,QAAT,GAAoB;AACzB,MAAI;AACF,UAAMC,GAAG,GAAGN,YAAY,CAACO,OAAb,CAAqBjB,KAArB,CAAZ;AACA,WAAOH,SAAS,CAACmB,GAAD,CAAhB;AACD,GAHD,CAGE,OAAOE,KAAP,EAAc;AACd,WAAO,IAAP;AACD;AACF;AACD,OAAO,SAASC,OAAT,GAAmB;AACxB,MAAI;AACF,UAAMH,GAAG,GAAGN,YAAY,CAACO,OAAb,CAAqBhB,IAArB,CAAZ;AACA,WAAOJ,SAAS,CAACmB,GAAD,CAAhB;AACD,GAHD,CAGE,OAAOE,KAAP,EAAc;AACd,WAAO,IAAP;AACD;AACF","sourcesContent":["import jwtDecode from \"jwt-decode\";\nimport https from \"./httpService\";\nimport { apiUrl, admin, user, name } from \"../config.json\";\nimport { openNotification } from \"../components/custom\";\n\nexport function login(values, history) {\n  return https.post(apiUrl + \"user/login\", values).then(res => {\n    localStorage.setItem(admin, res.data.admin);\n    localStorage.setItem(user, res.data.user);\n    localStorage.setItem(name, res.data.data);\n    if (res.data.status === 200) {\n      history.replace(\"/admin\");\n      openNotification(\"success\", `${res.data.data} Successfully logged in`);\n    } else if (res.data.status === 302) {\n      history.replace(\"/user\");\n      openNotification(\"success\", `${res.data.data} Successfully logged in`);\n    } else if (res.data.status === 401) {\n      return openNotification(\n        \"error\",\n        \"Email or Password is not valid\",\n        \"Please retype Email or Password\"\n      );\n    } else if (res.data.status === 404) {\n      return openNotification(\n        \"error\",\n        \"Email or Password is not valid\",\n        \"Please retype Email or Password\"\n      );\n    }\n  });\n}\n\nexport function getAdmin() {\n  try {\n    const jwt = localStorage.getItem(admin);\n    return jwtDecode(jwt);\n  } catch (error) {\n    return null;\n  }\n}\nexport function getUser() {\n  try {\n    const jwt = localStorage.getItem(user);\n    return jwtDecode(jwt);\n  } catch (error) {\n    return null;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}