{"ast":null,"code":"/*\n * Chartkick.js\n * Create beautiful charts with one line of JavaScript\n * https://github.com/ankane/chartkick.js\n * v3.2.0\n * MIT License\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.Chartkick = factory());\n})(this, function () {\n  'use strict';\n\n  function isArray(variable) {\n    return Object.prototype.toString.call(variable) === \"[object Array]\";\n  }\n\n  function isFunction(variable) {\n    return variable instanceof Function;\n  }\n\n  function isPlainObject(variable) {\n    // protect against prototype pollution, defense 2\n    return Object.prototype.toString.call(variable) === \"[object Object]\" && !isFunction(variable) && variable instanceof Object;\n  } // https://github.com/madrobby/zepto/blob/master/src/zepto.js\n\n\n  function extend(target, source) {\n    var key;\n\n    for (key in source) {\n      // protect against prototype pollution, defense 1\n      if (key === \"__proto__\") {\n        continue;\n      }\n\n      if (isPlainObject(source[key]) || isArray(source[key])) {\n        if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n          target[key] = {};\n        }\n\n        if (isArray(source[key]) && !isArray(target[key])) {\n          target[key] = [];\n        }\n\n        extend(target[key], source[key]);\n      } else if (source[key] !== undefined) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  function merge(obj1, obj2) {\n    var target = {};\n    extend(target, obj1);\n    extend(target, obj2);\n    return target;\n  }\n\n  var DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i; // https://github.com/Do/iso8601.js\n\n  var ISO8601_PATTERN = /(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)(T)?(\\d\\d)(:)?(\\d\\d)?(:)?(\\d\\d)?([.,]\\d+)?($|Z|([+-])(\\d\\d)(:)?(\\d\\d)?)/i;\n  var DECIMAL_SEPARATOR = String(1.5).charAt(1);\n\n  function parseISO8601(input) {\n    var day, hour, matches, milliseconds, minutes, month, offset, result, seconds, type, year;\n    type = Object.prototype.toString.call(input);\n\n    if (type === \"[object Date]\") {\n      return input;\n    }\n\n    if (type !== \"[object String]\") {\n      return;\n    }\n\n    matches = input.match(ISO8601_PATTERN);\n\n    if (matches) {\n      year = parseInt(matches[1], 10);\n      month = parseInt(matches[3], 10) - 1;\n      day = parseInt(matches[5], 10);\n      hour = parseInt(matches[7], 10);\n      minutes = matches[9] ? parseInt(matches[9], 10) : 0;\n      seconds = matches[11] ? parseInt(matches[11], 10) : 0;\n      milliseconds = matches[12] ? parseFloat(DECIMAL_SEPARATOR + matches[12].slice(1)) * 1000 : 0;\n      result = Date.UTC(year, month, day, hour, minutes, seconds, milliseconds);\n\n      if (matches[13] && matches[14]) {\n        offset = matches[15] * 60;\n\n        if (matches[17]) {\n          offset += parseInt(matches[17], 10);\n        }\n\n        offset *= matches[14] === \"-\" ? -1 : 1;\n        result -= offset * 60 * 1000;\n      }\n\n      return new Date(result);\n    }\n  } // end iso8601.js\n\n\n  function negativeValues(series) {\n    var i, j, data;\n\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n\n      for (j = 0; j < data.length; j++) {\n        if (data[j][1] < 0) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  function toStr(n) {\n    return \"\" + n;\n  }\n\n  function toFloat(n) {\n    return parseFloat(n);\n  }\n\n  function toDate(n) {\n    var matches, year, month, day;\n\n    if (typeof n !== \"object\") {\n      if (typeof n === \"number\") {\n        n = new Date(n * 1000); // ms\n      } else {\n        n = toStr(n);\n\n        if (matches = n.match(DATE_PATTERN)) {\n          year = parseInt(matches[1], 10);\n          month = parseInt(matches[3], 10) - 1;\n          day = parseInt(matches[5], 10);\n          return new Date(year, month, day);\n        } else {\n          // str\n          // try our best to get the str into iso8601\n          // TODO be smarter about this\n          var str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n          n = parseISO8601(str) || new Date(n);\n        }\n      }\n    }\n\n    return n;\n  }\n\n  function toArr(n) {\n    if (!isArray(n)) {\n      var arr = [],\n          i;\n\n      for (i in n) {\n        if (n.hasOwnProperty(i)) {\n          arr.push([i, n[i]]);\n        }\n      }\n\n      n = arr;\n    }\n\n    return n;\n  }\n\n  function jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n    return function (chart, opts, chartOptions) {\n      var series = chart.data;\n      var options = merge({}, defaultOptions);\n      options = merge(options, chartOptions || {});\n\n      if (chart.hideLegend || \"legend\" in opts) {\n        hideLegend(options, opts.legend, chart.hideLegend);\n      }\n\n      if (opts.title) {\n        setTitle(options, opts.title);\n      } // min\n\n\n      if (\"min\" in opts) {\n        setMin(options, opts.min);\n      } else if (!negativeValues(series)) {\n        setMin(options, 0);\n      } // max\n\n\n      if (opts.max) {\n        setMax(options, opts.max);\n      }\n\n      if (\"stacked\" in opts) {\n        setStacked(options, opts.stacked);\n      }\n\n      if (opts.colors) {\n        options.colors = opts.colors;\n      }\n\n      if (opts.xtitle) {\n        setXtitle(options, opts.xtitle);\n      }\n\n      if (opts.ytitle) {\n        setYtitle(options, opts.ytitle);\n      } // merge library last\n\n\n      options = merge(options, opts.library || {});\n      return options;\n    };\n  }\n\n  function sortByTime(a, b) {\n    return a[0].getTime() - b[0].getTime();\n  }\n\n  function sortByNumberSeries(a, b) {\n    return a[0] - b[0];\n  }\n\n  function sortByNumber(a, b) {\n    return a - b;\n  }\n\n  function isMinute(d) {\n    return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n  }\n\n  function isHour(d) {\n    return isMinute(d) && d.getMinutes() === 0;\n  }\n\n  function isDay(d) {\n    return isHour(d) && d.getHours() === 0;\n  }\n\n  function isWeek(d, dayOfWeek) {\n    return isDay(d) && d.getDay() === dayOfWeek;\n  }\n\n  function isMonth(d) {\n    return isDay(d) && d.getDate() === 1;\n  }\n\n  function isYear(d) {\n    return isMonth(d) && d.getMonth() === 0;\n  }\n\n  function isDate(obj) {\n    return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n  }\n\n  function isNumber(obj) {\n    return typeof obj === \"number\";\n  }\n\n  function formatValue(pre, value, options, axis) {\n    pre = pre || \"\";\n\n    if (options.prefix) {\n      if (value < 0) {\n        value = value * -1;\n        pre += \"-\";\n      }\n\n      pre += options.prefix;\n    }\n\n    var suffix = options.suffix || \"\";\n    var precision = options.precision;\n    var round = options.round;\n\n    if (options.byteScale) {\n      var baseValue = axis ? options.byteScale : value;\n\n      if (baseValue >= 1099511627776) {\n        value /= 1099511627776;\n        suffix = \" TB\";\n      } else if (baseValue >= 1073741824) {\n        value /= 1073741824;\n        suffix = \" GB\";\n      } else if (baseValue >= 1048576) {\n        value /= 1048576;\n        suffix = \" MB\";\n      } else if (baseValue >= 1024) {\n        value /= 1024;\n        suffix = \" KB\";\n      } else {\n        suffix = \" bytes\";\n      }\n\n      if (precision === undefined && round === undefined) {\n        precision = 3;\n      }\n    }\n\n    if (precision !== undefined && round !== undefined) {\n      throw Error(\"Use either round or precision, not both\");\n    }\n\n    if (!axis) {\n      if (precision !== undefined) {\n        value = value.toPrecision(precision);\n\n        if (!options.zeros) {\n          value = parseFloat(value);\n        }\n      }\n\n      if (round !== undefined) {\n        if (round < 0) {\n          var num = Math.pow(10, -1 * round);\n          value = parseInt((1.0 * value / num).toFixed(0)) * num;\n        } else {\n          value = value.toFixed(round);\n\n          if (!options.zeros) {\n            value = parseFloat(value);\n          }\n        }\n      }\n    }\n\n    if (options.thousands || options.decimal) {\n      value = toStr(value);\n      var parts = value.split(\".\");\n      value = parts[0];\n\n      if (options.thousands) {\n        value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n      }\n\n      if (parts.length > 1) {\n        value += (options.decimal || \".\") + parts[1];\n      }\n    }\n\n    return pre + value + suffix;\n  }\n\n  function seriesOption(chart, series, option) {\n    if (option in series) {\n      return series[option];\n    } else if (option in chart.options) {\n      return chart.options[option];\n    }\n\n    return null;\n  }\n\n  function allZeros(data) {\n    var i, j, d;\n\n    for (i = 0; i < data.length; i++) {\n      d = data[i].data;\n\n      for (j = 0; j < d.length; j++) {\n        if (d[j][1] != 0) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  var baseOptions = {\n    maintainAspectRatio: false,\n    animation: false,\n    tooltips: {\n      displayColors: false,\n      callbacks: {}\n    },\n    legend: {},\n    title: {\n      fontSize: 20,\n      fontColor: \"#333\"\n    }\n  };\n  var defaultOptions = {\n    scales: {\n      yAxes: [{\n        ticks: {\n          maxTicksLimit: 4\n        },\n        scaleLabel: {\n          fontSize: 16,\n          // fontStyle: \"bold\",\n          fontColor: \"#333\"\n        }\n      }],\n      xAxes: [{\n        gridLines: {\n          drawOnChartArea: false\n        },\n        scaleLabel: {\n          fontSize: 16,\n          // fontStyle: \"bold\",\n          fontColor: \"#333\"\n        },\n        time: {},\n        ticks: {}\n      }]\n    }\n  }; // http://there4.io/2012/05/02/google-chart-color-list/\n\n  var defaultColors = [\"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\", \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\", \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"];\n\n  var hideLegend = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.display = !!legend;\n\n      if (legend && legend !== true) {\n        options.legend.position = legend;\n      }\n    } else if (hideLegend) {\n      options.legend.display = false;\n    }\n  };\n\n  var setTitle = function (options, title) {\n    options.title.display = true;\n    options.title.text = title;\n  };\n\n  var setMin = function (options, min) {\n    if (min !== null) {\n      options.scales.yAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setMax = function (options, max) {\n    options.scales.yAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setBarMin = function (options, min) {\n    if (min !== null) {\n      options.scales.xAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setBarMax = function (options, max) {\n    options.scales.xAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setStacked = function (options, stacked) {\n    options.scales.xAxes[0].stacked = !!stacked;\n    options.scales.yAxes[0].stacked = !!stacked;\n  };\n\n  var setXtitle = function (options, title) {\n    options.scales.xAxes[0].scaleLabel.display = true;\n    options.scales.xAxes[0].scaleLabel.labelString = title;\n  };\n\n  var setYtitle = function (options, title) {\n    options.scales.yAxes[0].scaleLabel.display = true;\n    options.scales.yAxes[0].scaleLabel.labelString = title;\n  }; // https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n\n\n  var addOpacity = function (hex, opacity) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n  }; // check if not null or undefined\n  // https://stackoverflow.com/a/27757708/1177228\n\n\n  var notnull = function (x) {\n    return x != null;\n  };\n\n  var setLabelSize = function (chart, data, options) {\n    var maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n\n    if (maxLabelSize > 25) {\n      maxLabelSize = 25;\n    } else if (maxLabelSize < 10) {\n      maxLabelSize = 10;\n    }\n\n    if (!options.scales.xAxes[0].ticks.callback) {\n      options.scales.xAxes[0].ticks.callback = function (value) {\n        value = toStr(value);\n\n        if (value.length > maxLabelSize) {\n          return value.substring(0, maxLabelSize - 2) + \"...\";\n        } else {\n          return value;\n        }\n      };\n    }\n  };\n\n  var setFormatOptions = function (chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chart.options.bytes) {\n      var series = chart.data;\n\n      if (chartType === \"pie\") {\n        series = [{\n          data: series\n        }];\n      } // calculate max\n\n\n      var max = 0;\n\n      for (var i = 0; i < series.length; i++) {\n        var s = series[i];\n\n        for (var j = 0; j < s.data.length; j++) {\n          if (s.data[j][1] > max) {\n            max = s.data[j][1];\n          }\n        }\n      } // calculate scale\n\n\n      var scale = 1;\n\n      while (max >= 1024) {\n        scale *= 1024;\n        max /= 1024;\n      } // set step size\n\n\n      formatOptions.byteScale = scale;\n    }\n\n    if (chartType !== \"pie\") {\n      var myAxes = options.scales.yAxes;\n\n      if (chartType === \"bar\") {\n        myAxes = options.scales.xAxes;\n      }\n\n      if (formatOptions.byteScale) {\n        if (!myAxes[0].ticks.stepSize) {\n          myAxes[0].ticks.stepSize = formatOptions.byteScale / 2;\n        }\n\n        if (!myAxes[0].ticks.maxTicksLimit) {\n          myAxes[0].ticks.maxTicksLimit = 4;\n        }\n      }\n\n      if (!myAxes[0].ticks.callback) {\n        myAxes[0].ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions, true);\n        };\n      }\n    }\n\n    if (!options.tooltips.callbacks.label) {\n      if (chartType === \"scatter\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ')';\n        };\n      } else if (chartType === \"bubble\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          var dataPoint = data.datasets[item.datasetIndex].data[item.index];\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ', ' + dataPoint.v + ')';\n        };\n      } else if (chartType === \"pie\") {\n        // need to use separate label for pie charts\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var dataLabel = data.labels[tooltipItem.index];\n          var value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index], formatOptions);\n        };\n      } else {\n        var valueLabel = chartType === \"bar\" ? \"xLabel\" : \"yLabel\";\n\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var label = data.datasets[tooltipItem.datasetIndex].label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          return formatValue(label, tooltipItem[valueLabel], formatOptions);\n        };\n      }\n    }\n  };\n\n  var jsOptions = jsOptionsFunc(merge(baseOptions, defaultOptions), hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\n  var createDataTable = function (chart, options, chartType, library) {\n    var datasets = [];\n    var labels = [];\n    var colors = chart.options.colors || defaultColors;\n    var day = true;\n    var week = true;\n    var dayOfWeek;\n    var month = true;\n    var year = true;\n    var hour = true;\n    var minute = true;\n    var series = chart.data;\n    var max = 0;\n\n    if (chartType === \"bubble\") {\n      for (var i$1 = 0; i$1 < series.length; i$1++) {\n        var s$1 = series[i$1];\n\n        for (var j$1 = 0; j$1 < s$1.data.length; j$1++) {\n          if (s$1.data[j$1][2] > max) {\n            max = s$1.data[j$1][2];\n          }\n        }\n      }\n    }\n\n    var i,\n        j,\n        s,\n        d,\n        key,\n        rows = [],\n        rows2 = [];\n\n    if (chartType === \"bar\" || chartType === \"column\" || chart.xtype !== \"number\" && chart.xtype !== \"bubble\") {\n      var sortedLabels = [];\n\n      for (i = 0; i < series.length; i++) {\n        s = series[i];\n\n        for (j = 0; j < s.data.length; j++) {\n          d = s.data[j];\n          key = chart.xtype == \"datetime\" ? d[0].getTime() : d[0];\n\n          if (!rows[key]) {\n            rows[key] = new Array(series.length);\n          }\n\n          rows[key][i] = toFloat(d[1]);\n\n          if (sortedLabels.indexOf(key) === -1) {\n            sortedLabels.push(key);\n          }\n        }\n      }\n\n      if (chart.xtype === \"datetime\" || chart.xtype === \"number\") {\n        sortedLabels.sort(sortByNumber);\n      }\n\n      for (j = 0; j < series.length; j++) {\n        rows2.push([]);\n      }\n\n      var value;\n      var k;\n\n      for (k = 0; k < sortedLabels.length; k++) {\n        i = sortedLabels[k];\n\n        if (chart.xtype === \"datetime\") {\n          value = new Date(toFloat(i)); // TODO make this efficient\n\n          day = day && isDay(value);\n\n          if (!dayOfWeek) {\n            dayOfWeek = value.getDay();\n          }\n\n          week = week && isWeek(value, dayOfWeek);\n          month = month && isMonth(value);\n          year = year && isYear(value);\n          hour = hour && isHour(value);\n          minute = minute && isMinute(value);\n        } else {\n          value = i;\n        }\n\n        labels.push(value);\n\n        for (j = 0; j < series.length; j++) {\n          // Chart.js doesn't like undefined\n          rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n        }\n      }\n    } else {\n      for (var i$2 = 0; i$2 < series.length; i$2++) {\n        var s$2 = series[i$2];\n        var d$1 = [];\n\n        for (var j$2 = 0; j$2 < s$2.data.length; j$2++) {\n          var point = {\n            x: toFloat(s$2.data[j$2][0]),\n            y: toFloat(s$2.data[j$2][1])\n          };\n\n          if (chartType === \"bubble\") {\n            point.r = toFloat(s$2.data[j$2][2]) * 20 / max; // custom attribute, for tooltip\n\n            point.v = s$2.data[j$2][2];\n          }\n\n          d$1.push(point);\n        }\n\n        rows2.push(d$1);\n      }\n    }\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      var color = s.color || colors[i];\n      var backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n      var dataset = {\n        label: s.name || \"\",\n        data: rows2[i],\n        fill: chartType === \"area\",\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        pointBackgroundColor: color,\n        borderWidth: 2,\n        pointHoverBackgroundColor: color\n      };\n\n      if (s.stack) {\n        dataset.stack = s.stack;\n      }\n\n      var curve = seriesOption(chart, s, \"curve\");\n\n      if (curve === false) {\n        dataset.lineTension = 0;\n      }\n\n      var points = seriesOption(chart, s, \"points\");\n\n      if (points === false) {\n        dataset.pointRadius = 0;\n        dataset.pointHitRadius = 5;\n      }\n\n      dataset = merge(dataset, chart.options.dataset || {});\n      dataset = merge(dataset, s.library || {});\n      dataset = merge(dataset, s.dataset || {});\n      datasets.push(dataset);\n    }\n\n    var xmin = chart.options.xmin;\n    var xmax = chart.options.xmax;\n\n    if (chart.xtype === \"datetime\") {\n      // hacky check for Chart.js >= 2.9.0\n      // https://github.com/chartjs/Chart.js/compare/v2.8.0...v2.9.0\n      var gte29 = \"math\" in library.helpers;\n      var ticksKey = gte29 ? \"ticks\" : \"time\";\n\n      if (notnull(xmin)) {\n        options.scales.xAxes[0][ticksKey].min = toDate(xmin).getTime();\n      }\n\n      if (notnull(xmax)) {\n        options.scales.xAxes[0][ticksKey].max = toDate(xmax).getTime();\n      }\n    } else if (chart.xtype === \"number\") {\n      if (notnull(xmin)) {\n        options.scales.xAxes[0].ticks.min = xmin;\n      }\n\n      if (notnull(xmax)) {\n        options.scales.xAxes[0].ticks.max = xmax;\n      }\n    }\n\n    if (chart.xtype === \"datetime\" && labels.length > 0) {\n      var minTime = (notnull(xmin) ? toDate(xmin) : labels[0]).getTime();\n      var maxTime = (notnull(xmax) ? toDate(xmax) : labels[0]).getTime();\n\n      for (i = 1; i < labels.length; i++) {\n        var value$1 = labels[i].getTime();\n\n        if (value$1 < minTime) {\n          minTime = value$1;\n        }\n\n        if (value$1 > maxTime) {\n          maxTime = value$1;\n        }\n      }\n\n      var timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n      if (!options.scales.xAxes[0].time.unit) {\n        var step;\n\n        if (year || timeDiff > 365 * 10) {\n          options.scales.xAxes[0].time.unit = \"year\";\n          step = 365;\n        } else if (month || timeDiff > 30 * 10) {\n          options.scales.xAxes[0].time.unit = \"month\";\n          step = 30;\n        } else if (day || timeDiff > 10) {\n          options.scales.xAxes[0].time.unit = \"day\";\n          step = 1;\n        } else if (hour || timeDiff > 0.5) {\n          options.scales.xAxes[0].time.displayFormats = {\n            hour: \"MMM D, h a\"\n          };\n          options.scales.xAxes[0].time.unit = \"hour\";\n          step = 1 / 24.0;\n        } else if (minute) {\n          options.scales.xAxes[0].time.displayFormats = {\n            minute: \"h:mm a\"\n          };\n          options.scales.xAxes[0].time.unit = \"minute\";\n          step = 1 / 24.0 / 60.0;\n        }\n\n        if (step && timeDiff > 0) {\n          var unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n\n          if (week && step === 1) {\n            unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n          }\n\n          options.scales.xAxes[0].time.unitStepSize = unitStepSize;\n        }\n      }\n\n      if (!options.scales.xAxes[0].time.tooltipFormat) {\n        if (day) {\n          options.scales.xAxes[0].time.tooltipFormat = \"ll\";\n        } else if (hour) {\n          options.scales.xAxes[0].time.tooltipFormat = \"MMM D, h a\";\n        } else if (minute) {\n          options.scales.xAxes[0].time.tooltipFormat = \"h:mm a\";\n        }\n      }\n    }\n\n    var data = {\n      labels: labels,\n      datasets: datasets\n    };\n    return data;\n  };\n\n  var defaultExport = function defaultExport(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  };\n\n  defaultExport.prototype.renderLineChart = function renderLineChart(chart, chartType) {\n    var chartOptions = {}; // fix for https://github.com/chartjs/Chart.js/issues/2441\n\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    var options = jsOptions(chart, merge(chartOptions, chart.options));\n    setFormatOptions(chart, options, chartType);\n    var data = createDataTable(chart, options, chartType || \"line\", this.library);\n\n    if (chart.xtype === \"number\") {\n      options.scales.xAxes[0].type = \"linear\";\n      options.scales.xAxes[0].position = \"bottom\";\n    } else {\n      options.scales.xAxes[0].type = chart.xtype === \"string\" ? \"category\" : \"time\";\n    }\n\n    this.drawChart(chart, \"line\", data, options);\n  };\n\n  defaultExport.prototype.renderPieChart = function renderPieChart(chart) {\n    var options = merge({}, baseOptions);\n\n    if (chart.options.donut) {\n      options.cutoutPercentage = 50;\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n    var labels = [];\n    var values = [];\n\n    for (var i = 0; i < chart.data.length; i++) {\n      var point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    var dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n    var data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n    this.drawChart(chart, \"pie\", data, options);\n  };\n\n  defaultExport.prototype.renderColumnChart = function renderColumnChart(chart, chartType) {\n    var options;\n\n    if (chartType === \"bar\") {\n      var barOptions = merge(baseOptions, defaultOptions);\n      delete barOptions.scales.yAxes[0].ticks.maxTicksLimit;\n      options = jsOptionsFunc(barOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options);\n    } else {\n      options = jsOptions(chart, chart.options);\n    }\n\n    setFormatOptions(chart, options, chartType);\n    var data = createDataTable(chart, options, \"column\", this.library);\n\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n\n    this.drawChart(chart, chartType === \"bar\" ? \"horizontalBar\" : \"bar\", data, options);\n  };\n\n  defaultExport.prototype.renderAreaChart = function renderAreaChart(chart) {\n    this.renderLineChart(chart, \"area\");\n  };\n\n  defaultExport.prototype.renderBarChart = function renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport.prototype.renderScatterChart = function renderScatterChart(chart, chartType) {\n    chartType = chartType || \"scatter\";\n    var options = jsOptions(chart, chart.options);\n    setFormatOptions(chart, options, chartType);\n\n    if (!(\"showLines\" in options)) {\n      options.showLines = false;\n    }\n\n    var data = createDataTable(chart, options, chartType, this.library);\n    options.scales.xAxes[0].type = \"linear\";\n    options.scales.xAxes[0].position = \"bottom\";\n    this.drawChart(chart, chartType, data, options);\n  };\n\n  defaultExport.prototype.renderBubbleChart = function renderBubbleChart(chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  };\n\n  defaultExport.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport.prototype.drawChart = function drawChart(chart, type, data, options) {\n    this.destroy(chart);\n    var chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.code) {\n      window.console.log(\"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\");\n    }\n\n    chart.element.innerHTML = \"<canvas></canvas>\";\n    var ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n    chart.chart = new this.library(ctx, chartOptions);\n  };\n\n  var defaultOptions$1 = {\n    chart: {},\n    xAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    yAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    title: {\n      text: null\n    },\n    credits: {\n      enabled: false\n    },\n    legend: {\n      borderWidth: 0\n    },\n    tooltip: {\n      style: {\n        fontSize: \"12px\"\n      }\n    },\n    plotOptions: {\n      areaspline: {},\n      area: {},\n      series: {\n        marker: {}\n      }\n    }\n  };\n\n  var hideLegend$1 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.enabled = !!legend;\n\n      if (legend && legend !== true) {\n        if (legend === \"top\" || legend === \"bottom\") {\n          options.legend.verticalAlign = legend;\n        } else {\n          options.legend.layout = \"vertical\";\n          options.legend.verticalAlign = \"middle\";\n          options.legend.align = legend;\n        }\n      }\n    } else if (hideLegend) {\n      options.legend.enabled = false;\n    }\n  };\n\n  var setTitle$1 = function (options, title) {\n    options.title.text = title;\n  };\n\n  var setMin$1 = function (options, min) {\n    options.yAxis.min = min;\n  };\n\n  var setMax$1 = function (options, max) {\n    options.yAxis.max = max;\n  };\n\n  var setStacked$1 = function (options, stacked) {\n    var stackedValue = stacked ? stacked === true ? \"normal\" : stacked : null;\n    options.plotOptions.series.stacking = stackedValue;\n    options.plotOptions.area.stacking = stackedValue;\n    options.plotOptions.areaspline.stacking = stackedValue;\n  };\n\n  var setXtitle$1 = function (options, title) {\n    options.xAxis.title.text = title;\n  };\n\n  var setYtitle$1 = function (options, title) {\n    options.yAxis.title.text = title;\n  };\n\n  var jsOptions$1 = jsOptionsFunc(defaultOptions$1, hideLegend$1, setTitle$1, setMin$1, setMax$1, setStacked$1, setXtitle$1, setYtitle$1);\n\n  var setFormatOptions$1 = function (chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + '\">\\u25CF</span> ' + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  };\n\n  var defaultExport$1 = function defaultExport(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  };\n\n  defaultExport$1.prototype.renderLineChart = function renderLineChart(chart, chartType) {\n    chartType = chartType || \"spline\";\n    var chartOptions = {};\n\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    var options = jsOptions$1(chart, chart.options, chartOptions),\n        data,\n        i,\n        j;\n    options.xAxis.type = chart.xtype === \"string\" ? \"category\" : chart.xtype === \"number\" ? \"linear\" : \"datetime\";\n\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n\n    setFormatOptions$1(chart, options, chartType);\n    var series = chart.data;\n\n    for (i = 0; i < series.length; i++) {\n      series[i].name = series[i].name || \"Value\";\n      data = series[i].data;\n\n      if (chart.xtype === \"datetime\") {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n\n      series[i].marker = {\n        symbol: \"circle\"\n      };\n\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderScatterChart = function renderScatterChart(chart) {\n    var options = jsOptions$1(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  };\n\n  defaultExport$1.prototype.renderPieChart = function renderPieChart(chart) {\n    var chartOptions = merge(defaultOptions$1, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {\n        pie: {\n          innerSize: \"50%\"\n        }\n      };\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$1(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$1(chartOptions, chart.options.title);\n    }\n\n    var options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions$1(chart, options, \"pie\");\n    var series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderColumnChart = function renderColumnChart(chart, chartType) {\n    chartType = chartType || \"column\";\n    var series = chart.data;\n    var options = jsOptions$1(chart, chart.options),\n        i,\n        j,\n        s,\n        d,\n        rows = [],\n        categories = [];\n    options.chart.type = chartType;\n    setFormatOptions$1(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n    var newSeries = [],\n        d2;\n\n    for (i = 0; i < series.length; i++) {\n      d = [];\n\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name || \"Value\",\n        data: d\n      };\n\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  };\n\n  defaultExport$1.prototype.renderBarChart = function renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$1.prototype.renderAreaChart = function renderAreaChart(chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  };\n\n  defaultExport$1.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$1.prototype.drawChart = function drawChart(chart, data, options) {\n    this.destroy(chart);\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.code) {\n      window.console.log(\"new Highcharts.Chart(\" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.Chart(options);\n  };\n\n  var loaded = {};\n  var callbacks = []; // Set chart options\n\n  var defaultOptions$2 = {\n    chartArea: {},\n    fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n    pointSize: 6,\n    legend: {\n      textStyle: {\n        fontSize: 12,\n        color: \"#444\"\n      },\n      alignment: \"center\",\n      position: \"right\"\n    },\n    curveType: \"function\",\n    hAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      gridlines: {\n        color: \"transparent\"\n      },\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    vAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    tooltip: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      }\n    }\n  };\n\n  var hideLegend$2 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      var position;\n\n      if (!legend) {\n        position = \"none\";\n      } else if (legend === true) {\n        position = \"right\";\n      } else {\n        position = legend;\n      }\n\n      options.legend.position = position;\n    } else if (hideLegend) {\n      options.legend.position = \"none\";\n    }\n  };\n\n  var setTitle$2 = function (options, title) {\n    options.title = title;\n    options.titleTextStyle = {\n      color: \"#333\",\n      fontSize: \"20px\"\n    };\n  };\n\n  var setMin$2 = function (options, min) {\n    options.vAxis.viewWindow.min = min;\n  };\n\n  var setMax$2 = function (options, max) {\n    options.vAxis.viewWindow.max = max;\n  };\n\n  var setBarMin$1 = function (options, min) {\n    options.hAxis.viewWindow.min = min;\n  };\n\n  var setBarMax$1 = function (options, max) {\n    options.hAxis.viewWindow.max = max;\n  };\n\n  var setStacked$2 = function (options, stacked) {\n    options.isStacked = stacked ? stacked : false;\n  };\n\n  var setXtitle$2 = function (options, title) {\n    options.hAxis.title = title;\n    options.hAxis.titleTextStyle.italic = false;\n  };\n\n  var setYtitle$2 = function (options, title) {\n    options.vAxis.title = title;\n    options.vAxis.titleTextStyle.italic = false;\n  };\n\n  var jsOptions$2 = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setMin$2, setMax$2, setStacked$2, setXtitle$2, setYtitle$2);\n\n  var resize = function (callback) {\n    if (window.attachEvent) {\n      window.attachEvent(\"onresize\", callback);\n    } else if (window.addEventListener) {\n      window.addEventListener(\"resize\", callback, true);\n    }\n\n    callback();\n  };\n\n  var defaultExport$2 = function defaultExport(library) {\n    this.name = \"google\";\n    this.library = library;\n  };\n\n  defaultExport$2.prototype.renderLineChart = function renderLineChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"LineChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderPieChart = function renderPieChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n\n      if (\"legend\" in chart.options) {\n        hideLegend$2(chartOptions, chart.options.legend);\n      }\n\n      if (chart.options.title) {\n        setTitle$2(chartOptions, chart.options.title);\n      }\n\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n      this$1.drawChart(chart, \"PieChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderColumnChart = function renderColumnChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var options = jsOptions$2(chart, chart.options);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderBarChart = function renderBarChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      var options = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setBarMin$1, setBarMax$1, setStacked$2, setXtitle$2, setYtitle$2)(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"BarChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderAreaChart = function renderAreaChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"AreaChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderGeoChart = function renderGeoChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n      this$1.drawChart(chart, \"GeoChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderScatterChart = function renderScatterChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var series = chart.data,\n          rows2 = [],\n          i,\n          j,\n          data,\n          d;\n\n      for (i = 0; i < series.length; i++) {\n        series[i].name = series[i].name || \"Value\";\n        d = series[i].data;\n\n        for (j = 0; j < d.length; j++) {\n          var row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n\n      data.addRows(rows2);\n      this$1.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderTimeline = function renderTimeline(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, \"timeline\", function () {\n      var chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn({\n        type: \"string\",\n        id: \"Name\"\n      });\n      data.addColumn({\n        type: \"date\",\n        id: \"Start\"\n      });\n      data.addColumn({\n        type: \"date\",\n        id: \"End\"\n      });\n      data.addRows(chart.data);\n      chart.element.style.lineHeight = \"normal\";\n      this$1.drawChart(chart, \"Timeline\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  };\n\n  defaultExport$2.prototype.drawChart = function drawChart(chart, type, data, options) {\n    this.destroy(chart);\n\n    if (chart.options.code) {\n      window.console.log(\"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.visualization[type](chart.element);\n    resize(function () {\n      chart.chart.draw(data, options);\n    });\n  };\n\n  defaultExport$2.prototype.waitForLoaded = function waitForLoaded(chart, pack, callback) {\n    var this$1 = this;\n\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({\n      pack: pack,\n      callback: callback\n    });\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true; // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n\n      var loadOptions = {\n        packages: [pack],\n        callback: function () {\n          this$1.runCallbacks();\n        }\n      };\n\n      var config = chart.__config();\n\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n\n      if (pack === \"corechart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      this.library.charts.load(\"current\", loadOptions);\n    }\n  };\n\n  defaultExport$2.prototype.runCallbacks = function runCallbacks() {\n    var cb, call;\n\n    for (var i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && (cb.pack === \"corechart\" && this.library.visualization.LineChart || cb.pack === \"timeline\" && this.library.visualization.Timeline);\n\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  }; // cant use object as key\n\n\n  defaultExport$2.prototype.createDataTable = function createDataTable(series, columnType) {\n    var i,\n        j,\n        s,\n        d,\n        key,\n        rows = [],\n        sortedLabels = [];\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      series[i].name = series[i].name || \"Value\";\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = columnType === \"datetime\" ? d[0].getTime() : d[0];\n\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    var rows2 = [];\n    var day = true;\n    var value;\n\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n\n      rows2.push([value].concat(rows[i]));\n    }\n\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n\n      columnType = \"string\";\n    } // create datatable\n\n\n    var data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n\n    data.addRows(rows2);\n    return data;\n  };\n\n  var pendingRequests = [],\n      runningRequests = 0,\n      maxRequests = 4;\n\n  function pushRequest(url, success, error) {\n    pendingRequests.push([url, success, error]);\n    runNext();\n  }\n\n  function runNext() {\n    if (runningRequests < maxRequests) {\n      var request = pendingRequests.shift();\n\n      if (request) {\n        runningRequests++;\n        getJSON(request[0], request[1], request[2]);\n        runNext();\n      }\n    }\n  }\n\n  function requestComplete() {\n    runningRequests--;\n    runNext();\n  }\n\n  function getJSON(url, success, error) {\n    ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n      var message = typeof errorThrown === \"string\" ? errorThrown : errorThrown.message;\n      error(message);\n    });\n  }\n\n  function ajaxCall(url, success, error) {\n    var $ = window.jQuery || window.Zepto || window.$;\n\n    if ($ && $.ajax) {\n      $.ajax({\n        dataType: \"json\",\n        url: url,\n        success: success,\n        error: error,\n        complete: requestComplete\n      });\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n      xhr.onload = function () {\n        requestComplete();\n\n        if (xhr.status === 200) {\n          success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n        } else {\n          error(xhr, \"error\", xhr.statusText);\n        }\n      };\n\n      xhr.send();\n    }\n  }\n\n  var config = {};\n  var adapters = []; // helpers\n\n  function setText(element, text) {\n    if (document.body.innerText) {\n      element.innerText = text;\n    } else {\n      element.textContent = text;\n    }\n  } // TODO remove prefix for all messages\n\n\n  function chartError(element, message, noPrefix) {\n    if (!noPrefix) {\n      message = \"Error Loading Chart: \" + message;\n    }\n\n    setText(element, message);\n    element.style.color = \"#ff0000\";\n  }\n\n  function errorCatcher(chart) {\n    try {\n      chart.__render();\n    } catch (err) {\n      chartError(chart.element, err.message);\n      throw err;\n    }\n  }\n\n  function fetchDataSource(chart, dataSource) {\n    if (typeof dataSource === \"string\") {\n      pushRequest(dataSource, function (data) {\n        chart.rawData = data;\n        errorCatcher(chart);\n      }, function (message) {\n        chartError(chart.element, message);\n      });\n    } else if (typeof dataSource === \"function\") {\n      try {\n        dataSource(function (data) {\n          chart.rawData = data;\n          errorCatcher(chart);\n        }, function (message) {\n          chartError(chart.element, message, true);\n        });\n      } catch (err) {\n        chartError(chart.element, err, true);\n      }\n    } else {\n      chart.rawData = dataSource;\n      errorCatcher(chart);\n    }\n  }\n\n  function addDownloadButton(chart) {\n    var element = chart.element;\n    var link = document.createElement(\"a\");\n    var download = chart.options.download;\n\n    if (download === true) {\n      download = {};\n    } else if (typeof download === \"string\") {\n      download = {\n        filename: download\n      };\n    }\n\n    link.download = download.filename || \"chart.png\"; // https://caniuse.com/download\n\n    link.style.position = \"absolute\";\n    link.style.top = \"20px\";\n    link.style.right = \"20px\";\n    link.style.zIndex = 1000;\n    link.style.lineHeight = \"20px\";\n    link.target = \"_blank\"; // for safari\n\n    var image = document.createElement(\"img\");\n    image.alt = \"Download\";\n    image.style.border = \"none\"; // icon from font-awesome\n    // http://fa2png.io/\n\n    image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n    link.appendChild(image);\n    element.style.position = \"relative\";\n    chart.__downloadAttached = true; // mouseenter\n\n    chart.__enterEvent = addEvent(element, \"mouseover\", function (e) {\n      var related = e.relatedTarget; // check download option again to ensure it wasn't changed\n\n      if ((!related || related !== this && !childOf(this, related)) && chart.options.download) {\n        link.href = chart.toImage(download);\n        element.appendChild(link);\n      }\n    }); // mouseleave\n\n    chart.__leaveEvent = addEvent(element, \"mouseout\", function (e) {\n      var related = e.relatedTarget;\n\n      if (!related || related !== this && !childOf(this, related)) {\n        if (link.parentNode) {\n          link.parentNode.removeChild(link);\n        }\n      }\n    });\n  } // https://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\n\n\n  function addEvent(elem, event, fn) {\n    if (elem.addEventListener) {\n      elem.addEventListener(event, fn, false);\n      return fn;\n    } else {\n      var fn2 = function () {\n        // set the this pointer same as addEventListener when fn is called\n        return fn.call(elem, window.event);\n      };\n\n      elem.attachEvent(\"on\" + event, fn2);\n      return fn2;\n    }\n  }\n\n  function removeEvent(elem, event, fn) {\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, fn, false);\n    } else {\n      elem.detachEvent(\"on\" + event, fn);\n    }\n  } // https://gist.github.com/shawnbot/4166283\n\n\n  function childOf(p, c) {\n    if (p === c) {\n      return false;\n    }\n\n    while (c && c !== p) {\n      c = c.parentNode;\n    }\n\n    return c === p;\n  }\n\n  function getAdapterType(library) {\n    if (library) {\n      if (library.product === \"Highcharts\") {\n        return defaultExport$1;\n      } else if (library.charts) {\n        return defaultExport$2;\n      } else if (isFunction(library)) {\n        return defaultExport;\n      }\n    }\n\n    throw new Error(\"Unknown adapter\");\n  }\n\n  function addAdapter(library) {\n    var adapterType = getAdapterType(library);\n    var adapter = new adapterType(library);\n\n    if (adapters.indexOf(adapter) === -1) {\n      adapters.push(adapter);\n    }\n  }\n\n  function loadAdapters() {\n    if (\"Chart\" in window) {\n      addAdapter(window.Chart);\n    }\n\n    if (\"Highcharts\" in window) {\n      addAdapter(window.Highcharts);\n    }\n\n    if (window.google && window.google.charts) {\n      addAdapter(window.google);\n    }\n  }\n\n  function dataEmpty(data, chartType) {\n    if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n      return data.length === 0;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].data.length > 0) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n  }\n\n  function renderChart(chartType, chart) {\n    if (chart.options.messages && chart.options.messages.empty && dataEmpty(chart.data, chartType)) {\n      setText(chart.element, chart.options.messages.empty);\n    } else {\n      callAdapter(chartType, chart);\n\n      if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\") {\n        addDownloadButton(chart);\n      }\n    }\n  } // TODO remove chartType if cross-browser way\n  // to get the name of the chart class\n\n\n  function callAdapter(chartType, chart) {\n    var i, adapter, fnName, adapterName;\n    fnName = \"render\" + chartType;\n    adapterName = chart.options.adapter;\n    loadAdapters();\n\n    for (i = 0; i < adapters.length; i++) {\n      adapter = adapters[i];\n\n      if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n        chart.adapter = adapter.name;\n        chart.__adapterObject = adapter;\n        return adapter[fnName](chart);\n      }\n    }\n\n    if (adapters.length > 0) {\n      throw new Error(\"No charting library found for \" + chartType);\n    } else {\n      throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n    }\n  } // process data\n\n\n  var toFormattedKey = function (key, keyType) {\n    if (keyType === \"number\") {\n      key = toFloat(key);\n    } else if (keyType === \"datetime\") {\n      key = toDate(key);\n    } else {\n      key = toStr(key);\n    }\n\n    return key;\n  };\n\n  var formatSeriesData = function (data, keyType) {\n    var r = [],\n        key,\n        j;\n\n    for (j = 0; j < data.length; j++) {\n      if (keyType === \"bubble\") {\n        r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n      } else {\n        key = toFormattedKey(data[j][0], keyType);\n        r.push([key, toFloat(data[j][1])]);\n      }\n    }\n\n    if (keyType === \"datetime\") {\n      r.sort(sortByTime);\n    } else if (keyType === \"number\") {\n      r.sort(sortByNumberSeries);\n    }\n\n    return r;\n  };\n\n  function detectXType(series, noDatetime) {\n    if (detectXTypeWithFunction(series, isNumber)) {\n      return \"number\";\n    } else if (!noDatetime && detectXTypeWithFunction(series, isDate)) {\n      return \"datetime\";\n    } else {\n      return \"string\";\n    }\n  }\n\n  function detectXTypeWithFunction(series, func) {\n    var i, j, data;\n\n    for (i = 0; i < series.length; i++) {\n      data = toArr(series[i].data);\n\n      for (j = 0; j < data.length; j++) {\n        if (!func(data[j][0])) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  } // creates a shallow copy of each element of the array\n  // elements are expected to be objects\n\n\n  function copySeries(series) {\n    var newSeries = [],\n        i,\n        j;\n\n    for (i = 0; i < series.length; i++) {\n      var copy = {};\n\n      for (j in series[i]) {\n        if (series[i].hasOwnProperty(j)) {\n          copy[j] = series[i][j];\n        }\n      }\n\n      newSeries.push(copy);\n    }\n\n    return newSeries;\n  }\n\n  function processSeries(chart, keyType, noDatetime) {\n    var i;\n    var opts = chart.options;\n    var series = chart.rawData; // see if one series or multiple\n\n    if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n      series = [{\n        name: opts.label,\n        data: series\n      }];\n      chart.hideLegend = true;\n    } else {\n      chart.hideLegend = false;\n    }\n\n    chart.xtype = keyType ? keyType : opts.discrete ? \"string\" : detectXType(series, noDatetime); // right format\n\n    series = copySeries(series);\n\n    for (i = 0; i < series.length; i++) {\n      series[i].data = formatSeriesData(toArr(series[i].data), chart.xtype);\n    }\n\n    return series;\n  }\n\n  function processSimple(chart) {\n    var perfectData = toArr(chart.rawData),\n        i;\n\n    for (i = 0; i < perfectData.length; i++) {\n      perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n    }\n\n    return perfectData;\n  } // define classes\n\n\n  var Chart = function Chart(element, dataSource, options) {\n    var elementId;\n\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n    Chartkick.charts[element.id] = this;\n    fetchDataSource(this, dataSource);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.getElement = function getElement() {\n    return this.element;\n  };\n\n  Chart.prototype.getDataSource = function getDataSource() {\n    return this.dataSource;\n  };\n\n  Chart.prototype.getData = function getData() {\n    return this.data;\n  };\n\n  Chart.prototype.getOptions = function getOptions() {\n    return this.options;\n  };\n\n  Chart.prototype.getChartObject = function getChartObject() {\n    return this.chart;\n  };\n\n  Chart.prototype.getAdapter = function getAdapter() {\n    return this.adapter;\n  };\n\n  Chart.prototype.updateData = function updateData(dataSource, options) {\n    this.dataSource = dataSource;\n\n    if (options) {\n      this.__updateOptions(options);\n    }\n\n    fetchDataSource(this, dataSource);\n  };\n\n  Chart.prototype.setOptions = function setOptions(options) {\n    this.__updateOptions(options);\n\n    this.redraw();\n  };\n\n  Chart.prototype.redraw = function redraw() {\n    fetchDataSource(this, this.rawData);\n  };\n\n  Chart.prototype.refreshData = function refreshData() {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      var sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      var url = this.dataSource + sep + \"_=\" + new Date().getTime();\n      fetchDataSource(this, url);\n    } else if (typeof this.dataSource === \"function\") {\n      fetchDataSource(this, this.dataSource);\n    }\n  };\n\n  Chart.prototype.startRefresh = function startRefresh() {\n    var this$1 = this;\n    var refresh = this.options.refresh;\n\n    if (refresh && typeof this.dataSource !== \"string\" && typeof this.dataSource !== \"function\") {\n      throw new Error(\"Data source must be a URL or callback for refresh\");\n    }\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval(function () {\n          this$1.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  };\n\n  Chart.prototype.stopRefresh = function stopRefresh() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  };\n\n  Chart.prototype.toImage = function toImage(download) {\n    if (this.adapter === \"chartjs\") {\n      if (download && download.background && download.background !== \"transparent\") {\n        // https://stackoverflow.com/questions/30464750/chartjs-line-chart-set-background-color\n        var canvas = this.chart.chart.canvas;\n        var ctx = this.chart.chart.ctx;\n        var tmpCanvas = document.createElement(\"canvas\");\n        var tmpCtx = tmpCanvas.getContext(\"2d\");\n        tmpCanvas.width = ctx.canvas.width;\n        tmpCanvas.height = ctx.canvas.height;\n        tmpCtx.fillStyle = download.background;\n        tmpCtx.fillRect(0, 0, tmpCanvas.width, tmpCanvas.height);\n        tmpCtx.drawImage(canvas, 0, 0);\n        return tmpCanvas.toDataURL(\"image/png\");\n      } else {\n        return this.chart.toBase64Image();\n      }\n    } else {\n      // TODO throw error in next major version\n      // throw new Error(\"Feature only available for Chart.js\");\n      return null;\n    }\n  };\n\n  Chart.prototype.destroy = function destroy() {\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  };\n\n  Chart.prototype.__updateOptions = function __updateOptions(options) {\n    var updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.__render = function __render() {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  };\n\n  Chart.prototype.__config = function __config() {\n    return config;\n  };\n\n  var LineChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function LineChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) LineChart.__proto__ = Chart;\n    LineChart.prototype = Object.create(Chart && Chart.prototype);\n    LineChart.prototype.constructor = LineChart;\n\n    LineChart.prototype.__processData = function __processData() {\n      return processSeries(this);\n    };\n\n    LineChart.prototype.__chartName = function __chartName() {\n      return \"LineChart\";\n    };\n\n    return LineChart;\n  }(Chart);\n\n  var PieChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function PieChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) PieChart.__proto__ = Chart;\n    PieChart.prototype = Object.create(Chart && Chart.prototype);\n    PieChart.prototype.constructor = PieChart;\n\n    PieChart.prototype.__processData = function __processData() {\n      return processSimple(this);\n    };\n\n    PieChart.prototype.__chartName = function __chartName() {\n      return \"PieChart\";\n    };\n\n    return PieChart;\n  }(Chart);\n\n  var ColumnChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function ColumnChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) ColumnChart.__proto__ = Chart;\n    ColumnChart.prototype = Object.create(Chart && Chart.prototype);\n    ColumnChart.prototype.constructor = ColumnChart;\n\n    ColumnChart.prototype.__processData = function __processData() {\n      return processSeries(this, null, true);\n    };\n\n    ColumnChart.prototype.__chartName = function __chartName() {\n      return \"ColumnChart\";\n    };\n\n    return ColumnChart;\n  }(Chart);\n\n  var BarChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function BarChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) BarChart.__proto__ = Chart;\n    BarChart.prototype = Object.create(Chart && Chart.prototype);\n    BarChart.prototype.constructor = BarChart;\n\n    BarChart.prototype.__processData = function __processData() {\n      return processSeries(this, null, true);\n    };\n\n    BarChart.prototype.__chartName = function __chartName() {\n      return \"BarChart\";\n    };\n\n    return BarChart;\n  }(Chart);\n\n  var AreaChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function AreaChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) AreaChart.__proto__ = Chart;\n    AreaChart.prototype = Object.create(Chart && Chart.prototype);\n    AreaChart.prototype.constructor = AreaChart;\n\n    AreaChart.prototype.__processData = function __processData() {\n      return processSeries(this);\n    };\n\n    AreaChart.prototype.__chartName = function __chartName() {\n      return \"AreaChart\";\n    };\n\n    return AreaChart;\n  }(Chart);\n\n  var GeoChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function GeoChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) GeoChart.__proto__ = Chart;\n    GeoChart.prototype = Object.create(Chart && Chart.prototype);\n    GeoChart.prototype.constructor = GeoChart;\n\n    GeoChart.prototype.__processData = function __processData() {\n      return processSimple(this);\n    };\n\n    GeoChart.prototype.__chartName = function __chartName() {\n      return \"GeoChart\";\n    };\n\n    return GeoChart;\n  }(Chart);\n\n  var ScatterChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function ScatterChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) ScatterChart.__proto__ = Chart;\n    ScatterChart.prototype = Object.create(Chart && Chart.prototype);\n    ScatterChart.prototype.constructor = ScatterChart;\n\n    ScatterChart.prototype.__processData = function __processData() {\n      return processSeries(this, \"number\");\n    };\n\n    ScatterChart.prototype.__chartName = function __chartName() {\n      return \"ScatterChart\";\n    };\n\n    return ScatterChart;\n  }(Chart);\n\n  var BubbleChart =\n  /*@__PURE__*/\n  function (Chart) {\n    function BubbleChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) BubbleChart.__proto__ = Chart;\n    BubbleChart.prototype = Object.create(Chart && Chart.prototype);\n    BubbleChart.prototype.constructor = BubbleChart;\n\n    BubbleChart.prototype.__processData = function __processData() {\n      return processSeries(this, \"bubble\");\n    };\n\n    BubbleChart.prototype.__chartName = function __chartName() {\n      return \"BubbleChart\";\n    };\n\n    return BubbleChart;\n  }(Chart);\n\n  var Timeline =\n  /*@__PURE__*/\n  function (Chart) {\n    function Timeline() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) Timeline.__proto__ = Chart;\n    Timeline.prototype = Object.create(Chart && Chart.prototype);\n    Timeline.prototype.constructor = Timeline;\n\n    Timeline.prototype.__processData = function __processData() {\n      var i,\n          data = this.rawData;\n\n      for (i = 0; i < data.length; i++) {\n        data[i][1] = toDate(data[i][1]);\n        data[i][2] = toDate(data[i][2]);\n      }\n\n      return data;\n    };\n\n    Timeline.prototype.__chartName = function __chartName() {\n      return \"Timeline\";\n    };\n\n    return Timeline;\n  }(Chart);\n\n  var Chartkick = {\n    LineChart: LineChart,\n    PieChart: PieChart,\n    ColumnChart: ColumnChart,\n    BarChart: BarChart,\n    AreaChart: AreaChart,\n    GeoChart: GeoChart,\n    ScatterChart: ScatterChart,\n    BubbleChart: BubbleChart,\n    Timeline: Timeline,\n    charts: {},\n    configure: function (options) {\n      for (var key in options) {\n        if (options.hasOwnProperty(key)) {\n          config[key] = options[key];\n        }\n      }\n    },\n    setDefaultOptions: function (opts) {\n      Chartkick.options = opts;\n    },\n    eachChart: function (callback) {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          callback(Chartkick.charts[chartId]);\n        }\n      }\n    },\n    config: config,\n    options: {},\n    adapters: adapters,\n    addAdapter: addAdapter,\n    use: function (adapter) {\n      addAdapter(adapter);\n      return Chartkick;\n    }\n  }; // not ideal, but allows for simpler integration\n\n  if (typeof window !== \"undefined\" && !window.Chartkick) {\n    window.Chartkick = Chartkick;\n  } // backwards compatibility for esm require\n\n\n  Chartkick.default = Chartkick;\n  return Chartkick;\n});","map":{"version":3,"sources":["/Users/abdurauf/Desktop//orginal/restaurant-management-system/plov/node_modules/chartkick/dist/chartkick.js"],"names":["global","factory","exports","module","define","amd","self","Chartkick","isArray","variable","Object","prototype","toString","call","isFunction","Function","isPlainObject","extend","target","source","key","undefined","merge","obj1","obj2","DATE_PATTERN","ISO8601_PATTERN","DECIMAL_SEPARATOR","String","charAt","parseISO8601","input","day","hour","matches","milliseconds","minutes","month","offset","result","seconds","type","year","match","parseInt","parseFloat","slice","Date","UTC","negativeValues","series","i","j","data","length","toStr","n","toFloat","toDate","str","replace","toArr","arr","hasOwnProperty","push","jsOptionsFunc","defaultOptions","hideLegend","setTitle","setMin","setMax","setStacked","setXtitle","setYtitle","chart","opts","chartOptions","options","legend","title","min","max","stacked","colors","xtitle","ytitle","library","sortByTime","a","b","getTime","sortByNumberSeries","sortByNumber","isMinute","d","getMilliseconds","getSeconds","isHour","getMinutes","isDay","getHours","isWeek","dayOfWeek","getDay","isMonth","getDate","isYear","getMonth","isDate","obj","isNaN","isNumber","formatValue","pre","value","axis","prefix","suffix","precision","round","byteScale","baseValue","Error","toPrecision","zeros","num","Math","pow","toFixed","thousands","decimal","parts","split","seriesOption","option","allZeros","baseOptions","maintainAspectRatio","animation","tooltips","displayColors","callbacks","fontSize","fontColor","scales","yAxes","ticks","maxTicksLimit","scaleLabel","xAxes","gridLines","drawOnChartArea","time","defaultColors","display","position","text","setBarMin","setBarMax","labelString","addOpacity","hex","opacity","exec","notnull","x","setLabelSize","maxLabelSize","ceil","element","offsetWidth","labels","callback","substring","setFormatOptions","chartType","formatOptions","bytes","s","scale","myAxes","stepSize","label","item","datasets","datasetIndex","xLabel","yLabel","dataPoint","index","v","tooltipItem","dataLabel","valueLabel","jsOptions","createDataTable","week","minute","i$1","s$1","j$1","rows","rows2","xtype","sortedLabels","Array","indexOf","sort","k","i$2","s$2","d$1","j$2","point","y","r","color","backgroundColor","dataset","name","fill","borderColor","pointBackgroundColor","borderWidth","pointHoverBackgroundColor","stack","curve","lineTension","points","pointRadius","pointHitRadius","xmin","xmax","gte29","helpers","ticksKey","minTime","maxTime","value$1","timeDiff","unit","step","displayFormats","unitStepSize","tooltipFormat","defaultExport","renderLineChart","drawChart","renderPieChart","donut","cutoutPercentage","values","renderColumnChart","barOptions","renderAreaChart","renderBarChart","renderScatterChart","showLines","renderBubbleChart","destroy","code","window","console","log","JSON","stringify","innerHTML","ctx","getElementsByTagName","defaultOptions$1","xAxis","style","yAxis","credits","enabled","tooltip","plotOptions","areaspline","area","marker","hideLegend$1","verticalAlign","layout","align","setTitle$1","setMin$1","setMax$1","setStacked$1","stackedValue","stacking","setXtitle$1","setYtitle$1","jsOptions$1","setFormatOptions$1","formatter","pointFormatter","defaultExport$1","symbol","pie","innerSize","categories","newSeries","d2","renderTo","id","Chart","loaded","defaultOptions$2","chartArea","fontName","pointSize","textStyle","alignment","curveType","hAxis","titleTextStyle","gridlines","baselineColor","viewWindow","vAxis","hideLegend$2","setTitle$2","setMin$2","setMax$2","setBarMin$1","setBarMax$1","setStacked$2","isStacked","setXtitle$2","italic","setYtitle$2","jsOptions$2","resize","attachEvent","addEventListener","defaultExport$2","this$1","waitForLoaded","top","height","pieHole","visualization","DataTable","addColumn","addRows","areaOpacity","renderGeoChart","colorAxis","row","renderTimeline","lineHeight","clearChart","toJSON","draw","pack","runCallbacks","loadOptions","packages","config","__config","language","mapsApiKey","charts","load","cb","LineChart","Timeline","splice","columnType","concat","pendingRequests","runningRequests","maxRequests","pushRequest","url","success","error","runNext","request","shift","getJSON","requestComplete","ajaxCall","jqXHR","textStatus","errorThrown","message","$","jQuery","Zepto","ajax","dataType","complete","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","parse","responseText","statusText","send","adapters","setText","document","body","innerText","textContent","chartError","noPrefix","errorCatcher","__render","err","fetchDataSource","dataSource","rawData","addDownloadButton","link","createElement","download","filename","right","zIndex","image","alt","border","src","appendChild","__downloadAttached","__enterEvent","addEvent","e","related","relatedTarget","childOf","href","toImage","__leaveEvent","parentNode","removeChild","elem","event","fn","fn2","removeEvent","removeEventListener","detachEvent","p","c","getAdapterType","product","addAdapter","adapterType","adapter","loadAdapters","Highcharts","google","dataEmpty","renderChart","messages","empty","callAdapter","fnName","adapterName","__adapterObject","toFormattedKey","keyType","formatSeriesData","detectXType","noDatetime","detectXTypeWithFunction","func","copySeries","copy","processSeries","discrete","processSimple","perfectData","elementId","getElementById","refresh","startRefresh","getElement","getDataSource","getData","getOptions","getChartObject","getAdapter","updateData","__updateOptions","setOptions","redraw","refreshData","sep","intervalId","setInterval","stopRefresh","clearInterval","background","canvas","tmpCanvas","tmpCtx","getContext","width","fillStyle","fillRect","drawImage","toDataURL","toBase64Image","updateRefresh","__processData","__chartName","apply","arguments","__proto__","create","constructor","PieChart","ColumnChart","BarChart","AreaChart","GeoChart","ScatterChart","BubbleChart","configure","setDefaultOptions","eachChart","chartId","use","default"],"mappings":"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","sourcesContent":["/*\n * Chartkick.js\n * Create beautiful charts with one line of JavaScript\n * https://github.com/ankane/chartkick.js\n * v3.2.0\n * MIT License\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Chartkick = factory());\n}(this, (function () { 'use strict';\n\n  function isArray(variable) {\n    return Object.prototype.toString.call(variable) === \"[object Array]\";\n  }\n\n  function isFunction(variable) {\n    return variable instanceof Function;\n  }\n\n  function isPlainObject(variable) {\n    // protect against prototype pollution, defense 2\n    return Object.prototype.toString.call(variable) === \"[object Object]\" && !isFunction(variable) && variable instanceof Object;\n  }\n\n  // https://github.com/madrobby/zepto/blob/master/src/zepto.js\n  function extend(target, source) {\n    var key;\n    for (key in source) {\n      // protect against prototype pollution, defense 1\n      if (key === \"__proto__\") { continue; }\n\n      if (isPlainObject(source[key]) || isArray(source[key])) {\n        if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n          target[key] = {};\n        }\n        if (isArray(source[key]) && !isArray(target[key])) {\n          target[key] = [];\n        }\n        extend(target[key], source[key]);\n      } else if (source[key] !== undefined) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  function merge(obj1, obj2) {\n    var target = {};\n    extend(target, obj1);\n    extend(target, obj2);\n    return target;\n  }\n\n  var DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i;\n\n  // https://github.com/Do/iso8601.js\n  var ISO8601_PATTERN = /(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)(T)?(\\d\\d)(:)?(\\d\\d)?(:)?(\\d\\d)?([.,]\\d+)?($|Z|([+-])(\\d\\d)(:)?(\\d\\d)?)/i;\n  var DECIMAL_SEPARATOR = String(1.5).charAt(1);\n\n  function parseISO8601(input) {\n    var day, hour, matches, milliseconds, minutes, month, offset, result, seconds, type, year;\n    type = Object.prototype.toString.call(input);\n    if (type === \"[object Date]\") {\n      return input;\n    }\n    if (type !== \"[object String]\") {\n      return;\n    }\n    matches = input.match(ISO8601_PATTERN);\n    if (matches) {\n      year = parseInt(matches[1], 10);\n      month = parseInt(matches[3], 10) - 1;\n      day = parseInt(matches[5], 10);\n      hour = parseInt(matches[7], 10);\n      minutes = matches[9] ? parseInt(matches[9], 10) : 0;\n      seconds = matches[11] ? parseInt(matches[11], 10) : 0;\n      milliseconds = matches[12] ? parseFloat(DECIMAL_SEPARATOR + matches[12].slice(1)) * 1000 : 0;\n      result = Date.UTC(year, month, day, hour, minutes, seconds, milliseconds);\n      if (matches[13] && matches[14]) {\n        offset = matches[15] * 60;\n        if (matches[17]) {\n          offset += parseInt(matches[17], 10);\n        }\n        offset *= matches[14] === \"-\" ? -1 : 1;\n        result -= offset * 60 * 1000;\n      }\n      return new Date(result);\n    }\n  }\n  // end iso8601.js\n\n  function negativeValues(series) {\n    var i, j, data;\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n      for (j = 0; j < data.length; j++) {\n        if (data[j][1] < 0) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function toStr(n) {\n    return \"\" + n;\n  }\n\n  function toFloat(n) {\n    return parseFloat(n);\n  }\n\n  function toDate(n) {\n    var matches, year, month, day;\n    if (typeof n !== \"object\") {\n      if (typeof n === \"number\") {\n        n = new Date(n * 1000); // ms\n      } else {\n        n = toStr(n);\n        if ((matches = n.match(DATE_PATTERN))) {\n        year = parseInt(matches[1], 10);\n        month = parseInt(matches[3], 10) - 1;\n        day = parseInt(matches[5], 10);\n        return new Date(year, month, day);\n        } else { // str\n          // try our best to get the str into iso8601\n          // TODO be smarter about this\n          var str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n          n = parseISO8601(str) || new Date(n);\n        }\n      }\n    }\n    return n;\n  }\n\n  function toArr(n) {\n    if (!isArray(n)) {\n      var arr = [], i;\n      for (i in n) {\n        if (n.hasOwnProperty(i)) {\n          arr.push([i, n[i]]);\n        }\n      }\n      n = arr;\n    }\n    return n;\n  }\n\n  function jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n    return function (chart, opts, chartOptions) {\n      var series = chart.data;\n      var options = merge({}, defaultOptions);\n      options = merge(options, chartOptions || {});\n\n      if (chart.hideLegend || \"legend\" in opts) {\n        hideLegend(options, opts.legend, chart.hideLegend);\n      }\n\n      if (opts.title) {\n        setTitle(options, opts.title);\n      }\n\n      // min\n      if (\"min\" in opts) {\n        setMin(options, opts.min);\n      } else if (!negativeValues(series)) {\n        setMin(options, 0);\n      }\n\n      // max\n      if (opts.max) {\n        setMax(options, opts.max);\n      }\n\n      if (\"stacked\" in opts) {\n        setStacked(options, opts.stacked);\n      }\n\n      if (opts.colors) {\n        options.colors = opts.colors;\n      }\n\n      if (opts.xtitle) {\n        setXtitle(options, opts.xtitle);\n      }\n\n      if (opts.ytitle) {\n        setYtitle(options, opts.ytitle);\n      }\n\n      // merge library last\n      options = merge(options, opts.library || {});\n\n      return options;\n    };\n  }\n\n  function sortByTime(a, b) {\n    return a[0].getTime() - b[0].getTime();\n  }\n\n  function sortByNumberSeries(a, b) {\n    return a[0] - b[0];\n  }\n\n  function sortByNumber(a, b) {\n    return a - b;\n  }\n\n  function isMinute(d) {\n    return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n  }\n\n  function isHour(d) {\n    return isMinute(d) && d.getMinutes() === 0;\n  }\n\n  function isDay(d) {\n    return isHour(d) && d.getHours() === 0;\n  }\n\n  function isWeek(d, dayOfWeek) {\n    return isDay(d) && d.getDay() === dayOfWeek;\n  }\n\n  function isMonth(d) {\n    return isDay(d) && d.getDate() === 1;\n  }\n\n  function isYear(d) {\n    return isMonth(d) && d.getMonth() === 0;\n  }\n\n  function isDate(obj) {\n    return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n  }\n\n  function isNumber(obj) {\n    return typeof obj === \"number\";\n  }\n\n  function formatValue(pre, value, options, axis) {\n    pre = pre || \"\";\n    if (options.prefix) {\n      if (value < 0) {\n        value = value * -1;\n        pre += \"-\";\n      }\n      pre += options.prefix;\n    }\n\n    var suffix = options.suffix || \"\";\n    var precision = options.precision;\n    var round = options.round;\n\n    if (options.byteScale) {\n      var baseValue = axis ? options.byteScale : value;\n      if (baseValue >= 1099511627776) {\n        value /= 1099511627776;\n        suffix = \" TB\";\n      } else if (baseValue >= 1073741824) {\n        value /= 1073741824;\n        suffix = \" GB\";\n      } else if (baseValue >= 1048576) {\n        value /= 1048576;\n        suffix = \" MB\";\n      } else if (baseValue >= 1024) {\n        value /= 1024;\n        suffix = \" KB\";\n      } else {\n        suffix = \" bytes\";\n      }\n\n      if (precision === undefined && round === undefined) {\n        precision = 3;\n      }\n    }\n\n    if (precision !== undefined && round !== undefined) {\n      throw Error(\"Use either round or precision, not both\");\n    }\n\n    if (!axis) {\n      if (precision !== undefined) {\n        value = value.toPrecision(precision);\n        if (!options.zeros) {\n          value = parseFloat(value);\n        }\n      }\n\n      if (round !== undefined) {\n        if (round < 0) {\n          var num = Math.pow(10, -1 * round);\n          value = parseInt((1.0 * value / num).toFixed(0)) * num;\n        } else {\n          value = value.toFixed(round);\n          if (!options.zeros) {\n            value = parseFloat(value);\n          }\n        }\n      }\n    }\n\n    if (options.thousands || options.decimal) {\n      value = toStr(value);\n      var parts = value.split(\".\");\n      value = parts[0];\n      if (options.thousands) {\n        value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n      }\n      if (parts.length > 1) {\n        value += (options.decimal || \".\") + parts[1];\n      }\n    }\n\n    return pre + value + suffix;\n  }\n\n  function seriesOption(chart, series, option) {\n    if (option in series) {\n      return series[option];\n    } else if (option in chart.options) {\n      return chart.options[option];\n    }\n    return null;\n  }\n\n  function allZeros(data) {\n    var i, j, d;\n    for (i = 0; i < data.length; i++) {\n      d = data[i].data;\n      for (j = 0; j < d.length; j++) {\n        if (d[j][1] != 0) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  var baseOptions = {\n    maintainAspectRatio: false,\n    animation: false,\n    tooltips: {\n      displayColors: false,\n      callbacks: {}\n    },\n    legend: {},\n    title: {fontSize: 20, fontColor: \"#333\"}\n  };\n\n  var defaultOptions = {\n    scales: {\n      yAxes: [\n        {\n          ticks: {\n            maxTicksLimit: 4\n          },\n          scaleLabel: {\n            fontSize: 16,\n            // fontStyle: \"bold\",\n            fontColor: \"#333\"\n          }\n        }\n      ],\n      xAxes: [\n        {\n          gridLines: {\n            drawOnChartArea: false\n          },\n          scaleLabel: {\n            fontSize: 16,\n            // fontStyle: \"bold\",\n            fontColor: \"#333\"\n          },\n          time: {},\n          ticks: {}\n        }\n      ]\n    }\n  };\n\n  // http://there4.io/2012/05/02/google-chart-color-list/\n  var defaultColors = [\n    \"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\",\n    \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\",\n    \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"\n  ];\n\n  var hideLegend = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.display = !!legend;\n      if (legend && legend !== true) {\n        options.legend.position = legend;\n      }\n    } else if (hideLegend) {\n      options.legend.display = false;\n    }\n  };\n\n  var setTitle = function (options, title) {\n    options.title.display = true;\n    options.title.text = title;\n  };\n\n  var setMin = function (options, min) {\n    if (min !== null) {\n      options.scales.yAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setMax = function (options, max) {\n    options.scales.yAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setBarMin = function (options, min) {\n    if (min !== null) {\n      options.scales.xAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setBarMax = function (options, max) {\n    options.scales.xAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setStacked = function (options, stacked) {\n    options.scales.xAxes[0].stacked = !!stacked;\n    options.scales.yAxes[0].stacked = !!stacked;\n  };\n\n  var setXtitle = function (options, title) {\n    options.scales.xAxes[0].scaleLabel.display = true;\n    options.scales.xAxes[0].scaleLabel.labelString = title;\n  };\n\n  var setYtitle = function (options, title) {\n    options.scales.yAxes[0].scaleLabel.display = true;\n    options.scales.yAxes[0].scaleLabel.labelString = title;\n  };\n\n  // https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n  var addOpacity = function(hex, opacity) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n  };\n\n  // check if not null or undefined\n  // https://stackoverflow.com/a/27757708/1177228\n  var notnull = function(x) {\n    return x != null;\n  };\n\n  var setLabelSize = function (chart, data, options) {\n    var maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n    if (maxLabelSize > 25) {\n      maxLabelSize = 25;\n    } else if (maxLabelSize < 10) {\n      maxLabelSize = 10;\n    }\n    if (!options.scales.xAxes[0].ticks.callback) {\n      options.scales.xAxes[0].ticks.callback = function (value) {\n        value = toStr(value);\n        if (value.length > maxLabelSize) {\n          return value.substring(0, maxLabelSize - 2) + \"...\";\n        } else {\n          return value;\n        }\n      };\n    }\n  };\n\n  var setFormatOptions = function(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chart.options.bytes) {\n      var series = chart.data;\n      if (chartType === \"pie\") {\n        series = [{data: series}];\n      }\n\n      // calculate max\n      var max = 0;\n      for (var i = 0; i < series.length; i++) {\n        var s = series[i];\n        for (var j = 0; j < s.data.length; j++) {\n          if (s.data[j][1] > max) {\n            max = s.data[j][1];\n          }\n        }\n      }\n\n      // calculate scale\n      var scale = 1;\n      while (max >= 1024) {\n        scale *= 1024;\n        max /= 1024;\n      }\n\n      // set step size\n      formatOptions.byteScale = scale;\n    }\n\n    if (chartType !== \"pie\") {\n      var myAxes = options.scales.yAxes;\n      if (chartType === \"bar\") {\n        myAxes = options.scales.xAxes;\n      }\n\n      if (formatOptions.byteScale) {\n        if (!myAxes[0].ticks.stepSize) {\n          myAxes[0].ticks.stepSize = formatOptions.byteScale / 2;\n        }\n        if (!myAxes[0].ticks.maxTicksLimit) {\n          myAxes[0].ticks.maxTicksLimit = 4;\n        }\n      }\n\n      if (!myAxes[0].ticks.callback) {\n        myAxes[0].ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions, true);\n        };\n      }\n    }\n\n    if (!options.tooltips.callbacks.label) {\n      if (chartType === \"scatter\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ')';\n        };\n      } else if (chartType === \"bubble\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          var dataPoint = data.datasets[item.datasetIndex].data[item.index];\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ', ' + dataPoint.v + ')';\n        };\n      } else if (chartType === \"pie\") {\n        // need to use separate label for pie charts\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var dataLabel = data.labels[tooltipItem.index];\n          var value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index], formatOptions);\n        };\n      } else {\n        var valueLabel = chartType === \"bar\" ? \"xLabel\" : \"yLabel\";\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var label = data.datasets[tooltipItem.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          return formatValue(label, tooltipItem[valueLabel], formatOptions);\n        };\n      }\n    }\n  };\n\n  var jsOptions = jsOptionsFunc(merge(baseOptions, defaultOptions), hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\n  var createDataTable = function (chart, options, chartType, library) {\n    var datasets = [];\n    var labels = [];\n\n    var colors = chart.options.colors || defaultColors;\n\n    var day = true;\n    var week = true;\n    var dayOfWeek;\n    var month = true;\n    var year = true;\n    var hour = true;\n    var minute = true;\n\n    var series = chart.data;\n\n    var max = 0;\n    if (chartType === \"bubble\") {\n      for (var i$1 = 0; i$1 < series.length; i$1++) {\n        var s$1 = series[i$1];\n        for (var j$1 = 0; j$1 < s$1.data.length; j$1++) {\n          if (s$1.data[j$1][2] > max) {\n            max = s$1.data[j$1][2];\n          }\n        }\n      }\n    }\n\n    var i, j, s, d, key, rows = [], rows2 = [];\n\n    if (chartType === \"bar\" || chartType === \"column\" || (chart.xtype !== \"number\" && chart.xtype !== \"bubble\")) {\n      var sortedLabels = [];\n\n      for (i = 0; i < series.length; i++) {\n        s = series[i];\n\n        for (j = 0; j < s.data.length; j++) {\n          d = s.data[j];\n          key = chart.xtype == \"datetime\" ? d[0].getTime() : d[0];\n          if (!rows[key]) {\n            rows[key] = new Array(series.length);\n          }\n          rows[key][i] = toFloat(d[1]);\n          if (sortedLabels.indexOf(key) === -1) {\n            sortedLabels.push(key);\n          }\n        }\n      }\n\n      if (chart.xtype === \"datetime\" || chart.xtype === \"number\") {\n        sortedLabels.sort(sortByNumber);\n      }\n\n      for (j = 0; j < series.length; j++) {\n        rows2.push([]);\n      }\n\n      var value;\n      var k;\n      for (k = 0; k < sortedLabels.length; k++) {\n        i = sortedLabels[k];\n        if (chart.xtype === \"datetime\") {\n          value = new Date(toFloat(i));\n          // TODO make this efficient\n          day = day && isDay(value);\n          if (!dayOfWeek) {\n            dayOfWeek = value.getDay();\n          }\n          week = week && isWeek(value, dayOfWeek);\n          month = month && isMonth(value);\n          year = year && isYear(value);\n          hour = hour && isHour(value);\n          minute = minute && isMinute(value);\n        } else {\n          value = i;\n        }\n        labels.push(value);\n        for (j = 0; j < series.length; j++) {\n          // Chart.js doesn't like undefined\n          rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n        }\n      }\n    } else {\n      for (var i$2 = 0; i$2 < series.length; i$2++) {\n        var s$2 = series[i$2];\n        var d$1 = [];\n        for (var j$2 = 0; j$2 < s$2.data.length; j$2++) {\n          var point = {\n            x: toFloat(s$2.data[j$2][0]),\n            y: toFloat(s$2.data[j$2][1])\n          };\n          if (chartType === \"bubble\") {\n            point.r = toFloat(s$2.data[j$2][2]) * 20 / max;\n            // custom attribute, for tooltip\n            point.v = s$2.data[j$2][2];\n          }\n          d$1.push(point);\n        }\n        rows2.push(d$1);\n      }\n    }\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      var color = s.color || colors[i];\n      var backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n\n      var dataset = {\n        label: s.name || \"\",\n        data: rows2[i],\n        fill: chartType === \"area\",\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        pointBackgroundColor: color,\n        borderWidth: 2,\n        pointHoverBackgroundColor: color\n      };\n\n      if (s.stack) {\n        dataset.stack = s.stack;\n      }\n\n      var curve = seriesOption(chart, s, \"curve\");\n      if (curve === false) {\n        dataset.lineTension = 0;\n      }\n\n      var points = seriesOption(chart, s, \"points\");\n      if (points === false) {\n        dataset.pointRadius = 0;\n        dataset.pointHitRadius = 5;\n      }\n\n      dataset = merge(dataset, chart.options.dataset || {});\n      dataset = merge(dataset, s.library || {});\n      dataset = merge(dataset, s.dataset || {});\n\n      datasets.push(dataset);\n    }\n\n    var xmin = chart.options.xmin;\n    var xmax = chart.options.xmax;\n\n    if (chart.xtype === \"datetime\") {\n      // hacky check for Chart.js >= 2.9.0\n      // https://github.com/chartjs/Chart.js/compare/v2.8.0...v2.9.0\n      var gte29 = \"math\" in library.helpers;\n      var ticksKey = gte29 ? \"ticks\" : \"time\";\n      if (notnull(xmin)) {\n        options.scales.xAxes[0][ticksKey].min = toDate(xmin).getTime();\n      }\n      if (notnull(xmax)) {\n        options.scales.xAxes[0][ticksKey].max = toDate(xmax).getTime();\n      }\n    } else if (chart.xtype === \"number\") {\n      if (notnull(xmin)) {\n        options.scales.xAxes[0].ticks.min = xmin;\n      }\n      if (notnull(xmax)) {\n        options.scales.xAxes[0].ticks.max = xmax;\n      }\n    }\n\n    if (chart.xtype === \"datetime\" && labels.length > 0) {\n      var minTime = (notnull(xmin) ? toDate(xmin) : labels[0]).getTime();\n      var maxTime = (notnull(xmax) ? toDate(xmax) : labels[0]).getTime();\n\n      for (i = 1; i < labels.length; i++) {\n        var value$1 = labels[i].getTime();\n        if (value$1 < minTime) {\n          minTime = value$1;\n        }\n        if (value$1 > maxTime) {\n          maxTime = value$1;\n        }\n      }\n\n      var timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n      if (!options.scales.xAxes[0].time.unit) {\n        var step;\n        if (year || timeDiff > 365 * 10) {\n          options.scales.xAxes[0].time.unit = \"year\";\n          step = 365;\n        } else if (month || timeDiff > 30 * 10) {\n          options.scales.xAxes[0].time.unit = \"month\";\n          step = 30;\n        } else if (day || timeDiff > 10) {\n          options.scales.xAxes[0].time.unit = \"day\";\n          step = 1;\n        } else if (hour || timeDiff > 0.5) {\n          options.scales.xAxes[0].time.displayFormats = {hour: \"MMM D, h a\"};\n          options.scales.xAxes[0].time.unit = \"hour\";\n          step = 1 / 24.0;\n        } else if (minute) {\n          options.scales.xAxes[0].time.displayFormats = {minute: \"h:mm a\"};\n          options.scales.xAxes[0].time.unit = \"minute\";\n          step = 1 / 24.0 / 60.0;\n        }\n\n        if (step && timeDiff > 0) {\n          var unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n          if (week && step === 1) {\n            unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n          }\n          options.scales.xAxes[0].time.unitStepSize = unitStepSize;\n        }\n      }\n\n      if (!options.scales.xAxes[0].time.tooltipFormat) {\n        if (day) {\n          options.scales.xAxes[0].time.tooltipFormat = \"ll\";\n        } else if (hour) {\n          options.scales.xAxes[0].time.tooltipFormat = \"MMM D, h a\";\n        } else if (minute) {\n          options.scales.xAxes[0].time.tooltipFormat = \"h:mm a\";\n        }\n      }\n    }\n\n    var data = {\n      labels: labels,\n      datasets: datasets\n    };\n\n    return data;\n  };\n\n  var defaultExport = function defaultExport(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  };\n\n  defaultExport.prototype.renderLineChart = function renderLineChart (chart, chartType) {\n    var chartOptions = {};\n    // fix for https://github.com/chartjs/Chart.js/issues/2441\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    var options = jsOptions(chart, merge(chartOptions, chart.options));\n    setFormatOptions(chart, options, chartType);\n\n    var data = createDataTable(chart, options, chartType || \"line\", this.library);\n\n    if (chart.xtype === \"number\") {\n      options.scales.xAxes[0].type = \"linear\";\n      options.scales.xAxes[0].position = \"bottom\";\n    } else {\n      options.scales.xAxes[0].type = chart.xtype === \"string\" ? \"category\" : \"time\";\n    }\n\n    this.drawChart(chart, \"line\", data, options);\n  };\n\n  defaultExport.prototype.renderPieChart = function renderPieChart (chart) {\n    var options = merge({}, baseOptions);\n    if (chart.options.donut) {\n      options.cutoutPercentage = 50;\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n\n    var labels = [];\n    var values = [];\n    for (var i = 0; i < chart.data.length; i++) {\n      var point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    var dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n\n    var data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n\n    this.drawChart(chart, \"pie\", data, options);\n  };\n\n  defaultExport.prototype.renderColumnChart = function renderColumnChart (chart, chartType) {\n    var options;\n    if (chartType === \"bar\") {\n      var barOptions = merge(baseOptions, defaultOptions);\n      delete barOptions.scales.yAxes[0].ticks.maxTicksLimit;\n      options = jsOptionsFunc(barOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options);\n    } else {\n      options = jsOptions(chart, chart.options);\n    }\n    setFormatOptions(chart, options, chartType);\n    var data = createDataTable(chart, options, \"column\", this.library);\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n    this.drawChart(chart, (chartType === \"bar\" ? \"horizontalBar\" : \"bar\"), data, options);\n  };\n\n  defaultExport.prototype.renderAreaChart = function renderAreaChart (chart) {\n    this.renderLineChart(chart, \"area\");\n  };\n\n  defaultExport.prototype.renderBarChart = function renderBarChart (chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport.prototype.renderScatterChart = function renderScatterChart (chart, chartType) {\n    chartType = chartType || \"scatter\";\n\n    var options = jsOptions(chart, chart.options);\n    setFormatOptions(chart, options, chartType);\n\n    if (!(\"showLines\" in options)) {\n      options.showLines = false;\n    }\n\n    var data = createDataTable(chart, options, chartType, this.library);\n\n    options.scales.xAxes[0].type = \"linear\";\n    options.scales.xAxes[0].position = \"bottom\";\n\n    this.drawChart(chart, chartType, data, options);\n  };\n\n  defaultExport.prototype.renderBubbleChart = function renderBubbleChart (chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  };\n\n  defaultExport.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport.prototype.drawChart = function drawChart (chart, type, data, options) {\n    this.destroy(chart);\n\n    var chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.code) {\n      window.console.log(\"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\");\n    }\n\n    chart.element.innerHTML = \"<canvas></canvas>\";\n    var ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n    chart.chart = new this.library(ctx, chartOptions);\n  };\n\n  var defaultOptions$1 = {\n    chart: {},\n    xAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    yAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    title: {\n      text: null\n    },\n    credits: {\n      enabled: false\n    },\n    legend: {\n      borderWidth: 0\n    },\n    tooltip: {\n      style: {\n        fontSize: \"12px\"\n      }\n    },\n    plotOptions: {\n      areaspline: {},\n      area: {},\n      series: {\n        marker: {}\n      }\n    }\n  };\n\n  var hideLegend$1 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.enabled = !!legend;\n      if (legend && legend !== true) {\n        if (legend === \"top\" || legend === \"bottom\") {\n          options.legend.verticalAlign = legend;\n        } else {\n          options.legend.layout = \"vertical\";\n          options.legend.verticalAlign = \"middle\";\n          options.legend.align = legend;\n        }\n      }\n    } else if (hideLegend) {\n      options.legend.enabled = false;\n    }\n  };\n\n  var setTitle$1 = function (options, title) {\n    options.title.text = title;\n  };\n\n  var setMin$1 = function (options, min) {\n    options.yAxis.min = min;\n  };\n\n  var setMax$1 = function (options, max) {\n    options.yAxis.max = max;\n  };\n\n  var setStacked$1 = function (options, stacked) {\n    var stackedValue = stacked ? (stacked === true ? \"normal\" : stacked) : null;\n    options.plotOptions.series.stacking = stackedValue;\n    options.plotOptions.area.stacking = stackedValue;\n    options.plotOptions.areaspline.stacking = stackedValue;\n  };\n\n  var setXtitle$1 = function (options, title) {\n    options.xAxis.title.text = title;\n  };\n\n  var setYtitle$1 = function (options, title) {\n    options.yAxis.title.text = title;\n  };\n\n  var jsOptions$1 = jsOptionsFunc(defaultOptions$1, hideLegend$1, setTitle$1, setMin$1, setMax$1, setStacked$1, setXtitle$1, setYtitle$1);\n\n  var setFormatOptions$1 = function(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + '\">\\u25CF</span> ' + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  };\n\n  var defaultExport$1 = function defaultExport(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  };\n\n  defaultExport$1.prototype.renderLineChart = function renderLineChart (chart, chartType) {\n    chartType = chartType || \"spline\";\n    var chartOptions = {};\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    var options = jsOptions$1(chart, chart.options, chartOptions), data, i, j;\n    options.xAxis.type = chart.xtype === \"string\" ? \"category\" : (chart.xtype === \"number\" ? \"linear\" : \"datetime\");\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n    setFormatOptions$1(chart, options, chartType);\n\n    var series = chart.data;\n    for (i = 0; i < series.length; i++) {\n      series[i].name = series[i].name || \"Value\";\n      data = series[i].data;\n      if (chart.xtype === \"datetime\") {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n      series[i].marker = {symbol: \"circle\"};\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderScatterChart = function renderScatterChart (chart) {\n    var options = jsOptions$1(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  };\n\n  defaultExport$1.prototype.renderPieChart = function renderPieChart (chart) {\n    var chartOptions = merge(defaultOptions$1, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {pie: {innerSize: \"50%\"}};\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$1(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$1(chartOptions, chart.options.title);\n    }\n\n    var options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions$1(chart, options, \"pie\");\n    var series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderColumnChart = function renderColumnChart (chart, chartType) {\n    chartType = chartType || \"column\";\n    var series = chart.data;\n    var options = jsOptions$1(chart, chart.options), i, j, s, d, rows = [], categories = [];\n    options.chart.type = chartType;\n    setFormatOptions$1(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n\n    var newSeries = [], d2;\n    for (i = 0; i < series.length; i++) {\n      d = [];\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name || \"Value\",\n        data: d\n      };\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  };\n\n  defaultExport$1.prototype.renderBarChart = function renderBarChart (chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$1.prototype.renderAreaChart = function renderAreaChart (chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  };\n\n  defaultExport$1.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$1.prototype.drawChart = function drawChart (chart, data, options) {\n    this.destroy(chart);\n\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.code) {\n      window.console.log(\"new Highcharts.Chart(\" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.Chart(options);\n  };\n\n  var loaded = {};\n  var callbacks = [];\n\n  // Set chart options\n  var defaultOptions$2 = {\n    chartArea: {},\n    fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n    pointSize: 6,\n    legend: {\n      textStyle: {\n        fontSize: 12,\n        color: \"#444\"\n      },\n      alignment: \"center\",\n      position: \"right\"\n    },\n    curveType: \"function\",\n    hAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      gridlines: {\n        color: \"transparent\"\n      },\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    vAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    tooltip: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      }\n    }\n  };\n\n  var hideLegend$2 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      var position;\n      if (!legend) {\n        position = \"none\";\n      } else if (legend === true) {\n        position = \"right\";\n      } else {\n        position = legend;\n      }\n      options.legend.position = position;\n    } else if (hideLegend) {\n      options.legend.position = \"none\";\n    }\n  };\n\n  var setTitle$2 = function (options, title) {\n    options.title = title;\n    options.titleTextStyle = {color: \"#333\", fontSize: \"20px\"};\n  };\n\n  var setMin$2 = function (options, min) {\n    options.vAxis.viewWindow.min = min;\n  };\n\n  var setMax$2 = function (options, max) {\n    options.vAxis.viewWindow.max = max;\n  };\n\n  var setBarMin$1 = function (options, min) {\n    options.hAxis.viewWindow.min = min;\n  };\n\n  var setBarMax$1 = function (options, max) {\n    options.hAxis.viewWindow.max = max;\n  };\n\n  var setStacked$2 = function (options, stacked) {\n    options.isStacked = stacked ? stacked : false;\n  };\n\n  var setXtitle$2 = function (options, title) {\n    options.hAxis.title = title;\n    options.hAxis.titleTextStyle.italic = false;\n  };\n\n  var setYtitle$2 = function (options, title) {\n    options.vAxis.title = title;\n    options.vAxis.titleTextStyle.italic = false;\n  };\n\n  var jsOptions$2 = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setMin$2, setMax$2, setStacked$2, setXtitle$2, setYtitle$2);\n\n  var resize = function (callback) {\n    if (window.attachEvent) {\n      window.attachEvent(\"onresize\", callback);\n    } else if (window.addEventListener) {\n      window.addEventListener(\"resize\", callback, true);\n    }\n    callback();\n  };\n\n  var defaultExport$2 = function defaultExport(library) {\n    this.name = \"google\";\n    this.library = library;\n  };\n\n  defaultExport$2.prototype.renderLineChart = function renderLineChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"LineChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderPieChart = function renderPieChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n      if (\"legend\" in chart.options) {\n        hideLegend$2(chartOptions, chart.options.legend);\n      }\n      if (chart.options.title) {\n        setTitle$2(chartOptions, chart.options.title);\n      }\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n\n      this$1.drawChart(chart, \"PieChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderColumnChart = function renderColumnChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var options = jsOptions$2(chart, chart.options);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderBarChart = function renderBarChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      var options = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setBarMin$1, setBarMax$1, setStacked$2, setXtitle$2, setYtitle$2)(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"BarChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderAreaChart = function renderAreaChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"AreaChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderGeoChart = function renderGeoChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n\n      this$1.drawChart(chart, \"GeoChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderScatterChart = function renderScatterChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n\n      var series = chart.data, rows2 = [], i, j, data, d;\n      for (i = 0; i < series.length; i++) {\n        series[i].name = series[i].name || \"Value\";\n        d = series[i].data;\n        for (j = 0; j < d.length; j++) {\n          var row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n      data.addRows(rows2);\n\n      this$1.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderTimeline = function renderTimeline (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, \"timeline\", function () {\n      var chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn({type: \"string\", id: \"Name\"});\n      data.addColumn({type: \"date\", id: \"Start\"});\n      data.addColumn({type: \"date\", id: \"End\"});\n      data.addRows(chart.data);\n\n      chart.element.style.lineHeight = \"normal\";\n\n      this$1.drawChart(chart, \"Timeline\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  };\n\n  defaultExport$2.prototype.drawChart = function drawChart (chart, type, data, options) {\n    this.destroy(chart);\n\n    if (chart.options.code) {\n      window.console.log(\"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.visualization[type](chart.element);\n    resize(function () {\n      chart.chart.draw(data, options);\n    });\n  };\n\n  defaultExport$2.prototype.waitForLoaded = function waitForLoaded (chart, pack, callback) {\n      var this$1 = this;\n\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({pack: pack, callback: callback});\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true;\n\n      // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n      var loadOptions = {\n        packages: [pack],\n        callback: function () { this$1.runCallbacks(); }\n      };\n      var config = chart.__config();\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n      if (pack === \"corechart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      this.library.charts.load(\"current\", loadOptions);\n    }\n  };\n\n  defaultExport$2.prototype.runCallbacks = function runCallbacks () {\n    var cb, call;\n    for (var i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && ((cb.pack === \"corechart\" && this.library.visualization.LineChart) || (cb.pack === \"timeline\" && this.library.visualization.Timeline));\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  };\n\n  // cant use object as key\n  defaultExport$2.prototype.createDataTable = function createDataTable (series, columnType) {\n    var i, j, s, d, key, rows = [], sortedLabels = [];\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      series[i].name = series[i].name || \"Value\";\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = (columnType === \"datetime\") ? d[0].getTime() : d[0];\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    var rows2 = [];\n    var day = true;\n    var value;\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n      rows2.push([value].concat(rows[i]));\n    }\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n\n      columnType = \"string\";\n    }\n\n    // create datatable\n    var data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n    data.addRows(rows2);\n\n    return data;\n  };\n\n  var pendingRequests = [], runningRequests = 0, maxRequests = 4;\n\n  function pushRequest(url, success, error) {\n    pendingRequests.push([url, success, error]);\n    runNext();\n  }\n\n  function runNext() {\n    if (runningRequests < maxRequests) {\n      var request = pendingRequests.shift();\n      if (request) {\n        runningRequests++;\n        getJSON(request[0], request[1], request[2]);\n        runNext();\n      }\n    }\n  }\n\n  function requestComplete() {\n    runningRequests--;\n    runNext();\n  }\n\n  function getJSON(url, success, error) {\n    ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n      var message = (typeof errorThrown === \"string\") ? errorThrown : errorThrown.message;\n      error(message);\n    });\n  }\n\n  function ajaxCall(url, success, error) {\n    var $ = window.jQuery || window.Zepto || window.$;\n\n    if ($ && $.ajax) {\n      $.ajax({\n        dataType: \"json\",\n        url: url,\n        success: success,\n        error: error,\n        complete: requestComplete\n      });\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.onload = function () {\n        requestComplete();\n        if (xhr.status === 200) {\n          success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n        } else {\n          error(xhr, \"error\", xhr.statusText);\n        }\n      };\n      xhr.send();\n    }\n  }\n\n  var config = {};\n  var adapters = [];\n\n  // helpers\n\n  function setText(element, text) {\n    if (document.body.innerText) {\n      element.innerText = text;\n    } else {\n      element.textContent = text;\n    }\n  }\n\n  // TODO remove prefix for all messages\n  function chartError(element, message, noPrefix) {\n    if (!noPrefix) {\n      message = \"Error Loading Chart: \" + message;\n    }\n    setText(element, message);\n    element.style.color = \"#ff0000\";\n  }\n\n  function errorCatcher(chart) {\n    try {\n      chart.__render();\n    } catch (err) {\n      chartError(chart.element, err.message);\n      throw err;\n    }\n  }\n\n  function fetchDataSource(chart, dataSource) {\n    if (typeof dataSource === \"string\") {\n      pushRequest(dataSource, function (data) {\n        chart.rawData = data;\n        errorCatcher(chart);\n      }, function (message) {\n        chartError(chart.element, message);\n      });\n    } else if (typeof dataSource === \"function\") {\n      try {\n        dataSource(function (data) {\n          chart.rawData = data;\n          errorCatcher(chart);\n        }, function (message) {\n          chartError(chart.element, message, true);\n        });\n      } catch (err) {\n        chartError(chart.element, err, true);\n      }\n    } else {\n      chart.rawData = dataSource;\n      errorCatcher(chart);\n    }\n  }\n\n  function addDownloadButton(chart) {\n    var element = chart.element;\n    var link = document.createElement(\"a\");\n\n    var download = chart.options.download;\n    if (download === true) {\n      download = {};\n    } else if (typeof download === \"string\") {\n      download = {filename: download};\n    }\n    link.download = download.filename || \"chart.png\"; // https://caniuse.com/download\n\n    link.style.position = \"absolute\";\n    link.style.top = \"20px\";\n    link.style.right = \"20px\";\n    link.style.zIndex = 1000;\n    link.style.lineHeight = \"20px\";\n    link.target = \"_blank\"; // for safari\n    var image = document.createElement(\"img\");\n    image.alt = \"Download\";\n    image.style.border = \"none\";\n    // icon from font-awesome\n    // http://fa2png.io/\n    image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n    link.appendChild(image);\n    element.style.position = \"relative\";\n\n    chart.__downloadAttached = true;\n\n    // mouseenter\n    chart.__enterEvent = addEvent(element, \"mouseover\", function(e) {\n      var related = e.relatedTarget;\n      // check download option again to ensure it wasn't changed\n      if ((!related || (related !== this && !childOf(this, related))) && chart.options.download) {\n        link.href = chart.toImage(download);\n        element.appendChild(link);\n      }\n    });\n\n    // mouseleave\n    chart.__leaveEvent = addEvent(element, \"mouseout\", function(e) {\n      var related = e.relatedTarget;\n      if (!related || (related !== this && !childOf(this, related))) {\n        if (link.parentNode) {\n          link.parentNode.removeChild(link);\n        }\n      }\n    });\n  }\n\n  // https://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\n  function addEvent(elem, event, fn) {\n    if (elem.addEventListener) {\n      elem.addEventListener(event, fn, false);\n      return fn;\n    } else {\n      var fn2 = function() {\n        // set the this pointer same as addEventListener when fn is called\n        return(fn.call(elem, window.event));\n      };\n      elem.attachEvent(\"on\" + event, fn2);\n      return fn2;\n    }\n  }\n\n  function removeEvent(elem, event, fn) {\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, fn, false);\n    } else {\n      elem.detachEvent(\"on\" + event, fn);\n    }\n  }\n\n  // https://gist.github.com/shawnbot/4166283\n  function childOf(p, c) {\n    if (p === c) { return false; }\n    while (c && c !== p) { c = c.parentNode; }\n    return c === p;\n  }\n\n  function getAdapterType(library) {\n    if (library) {\n      if (library.product === \"Highcharts\") {\n        return defaultExport$1;\n      } else if (library.charts) {\n        return defaultExport$2;\n      } else if (isFunction(library)) {\n        return defaultExport;\n      }\n    }\n    throw new Error(\"Unknown adapter\");\n  }\n\n  function addAdapter(library) {\n    var adapterType = getAdapterType(library);\n    var adapter = new adapterType(library);\n\n    if (adapters.indexOf(adapter) === -1) {\n      adapters.push(adapter);\n    }\n  }\n\n  function loadAdapters() {\n    if (\"Chart\" in window) {\n      addAdapter(window.Chart);\n    }\n\n    if (\"Highcharts\" in window) {\n      addAdapter(window.Highcharts);\n    }\n\n    if (window.google && window.google.charts) {\n      addAdapter(window.google);\n    }\n  }\n\n  function dataEmpty(data, chartType) {\n    if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n      return data.length === 0;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].data.length > 0) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  function renderChart(chartType, chart) {\n    if (chart.options.messages && chart.options.messages.empty && dataEmpty(chart.data, chartType)) {\n      setText(chart.element, chart.options.messages.empty);\n    } else {\n      callAdapter(chartType, chart);\n      if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\") {\n        addDownloadButton(chart);\n      }\n    }\n  }\n\n  // TODO remove chartType if cross-browser way\n  // to get the name of the chart class\n  function callAdapter(chartType, chart) {\n    var i, adapter, fnName, adapterName;\n    fnName = \"render\" + chartType;\n    adapterName = chart.options.adapter;\n\n    loadAdapters();\n\n    for (i = 0; i < adapters.length; i++) {\n      adapter = adapters[i];\n      if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n        chart.adapter = adapter.name;\n        chart.__adapterObject = adapter;\n        return adapter[fnName](chart);\n      }\n    }\n\n    if (adapters.length > 0) {\n      throw new Error(\"No charting library found for \" + chartType);\n    } else {\n      throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n    }\n  }\n\n  // process data\n\n  var toFormattedKey = function (key, keyType) {\n    if (keyType === \"number\") {\n      key = toFloat(key);\n    } else if (keyType === \"datetime\") {\n      key = toDate(key);\n    } else {\n      key = toStr(key);\n    }\n    return key;\n  };\n\n  var formatSeriesData = function (data, keyType) {\n    var r = [], key, j;\n    for (j = 0; j < data.length; j++) {\n      if (keyType === \"bubble\") {\n        r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n      } else {\n        key = toFormattedKey(data[j][0], keyType);\n        r.push([key, toFloat(data[j][1])]);\n      }\n    }\n    if (keyType === \"datetime\") {\n      r.sort(sortByTime);\n    } else if (keyType === \"number\") {\n      r.sort(sortByNumberSeries);\n    }\n    return r;\n  };\n\n  function detectXType(series, noDatetime) {\n    if (detectXTypeWithFunction(series, isNumber)) {\n      return \"number\";\n    } else if (!noDatetime && detectXTypeWithFunction(series, isDate)) {\n      return \"datetime\";\n    } else {\n      return \"string\";\n    }\n  }\n\n  function detectXTypeWithFunction(series, func) {\n    var i, j, data;\n    for (i = 0; i < series.length; i++) {\n      data = toArr(series[i].data);\n      for (j = 0; j < data.length; j++) {\n        if (!func(data[j][0])) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  // creates a shallow copy of each element of the array\n  // elements are expected to be objects\n  function copySeries(series) {\n    var newSeries = [], i, j;\n    for (i = 0; i < series.length; i++) {\n      var copy = {};\n      for (j in series[i]) {\n        if (series[i].hasOwnProperty(j)) {\n          copy[j] = series[i][j];\n        }\n      }\n      newSeries.push(copy);\n    }\n    return newSeries;\n  }\n\n  function processSeries(chart, keyType, noDatetime) {\n    var i;\n\n    var opts = chart.options;\n    var series = chart.rawData;\n\n    // see if one series or multiple\n    if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n      series = [{name: opts.label, data: series}];\n      chart.hideLegend = true;\n    } else {\n      chart.hideLegend = false;\n    }\n\n    chart.xtype = keyType ? keyType : (opts.discrete ? \"string\" : detectXType(series, noDatetime));\n\n    // right format\n    series = copySeries(series);\n    for (i = 0; i < series.length; i++) {\n      series[i].data = formatSeriesData(toArr(series[i].data), chart.xtype);\n    }\n\n    return series;\n  }\n\n  function processSimple(chart) {\n    var perfectData = toArr(chart.rawData), i;\n    for (i = 0; i < perfectData.length; i++) {\n      perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n    }\n    return perfectData;\n  }\n\n  // define classes\n\n  var Chart = function Chart(element, dataSource, options) {\n    var elementId;\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n\n    Chartkick.charts[element.id] = this;\n\n    fetchDataSource(this, dataSource);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.getElement = function getElement () {\n    return this.element;\n  };\n\n  Chart.prototype.getDataSource = function getDataSource () {\n    return this.dataSource;\n  };\n\n  Chart.prototype.getData = function getData () {\n    return this.data;\n  };\n\n  Chart.prototype.getOptions = function getOptions () {\n    return this.options;\n  };\n\n  Chart.prototype.getChartObject = function getChartObject () {\n    return this.chart;\n  };\n\n  Chart.prototype.getAdapter = function getAdapter () {\n    return this.adapter;\n  };\n\n  Chart.prototype.updateData = function updateData (dataSource, options) {\n    this.dataSource = dataSource;\n    if (options) {\n      this.__updateOptions(options);\n    }\n    fetchDataSource(this, dataSource);\n  };\n\n  Chart.prototype.setOptions = function setOptions (options) {\n    this.__updateOptions(options);\n    this.redraw();\n  };\n\n  Chart.prototype.redraw = function redraw () {\n    fetchDataSource(this, this.rawData);\n  };\n\n  Chart.prototype.refreshData = function refreshData () {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      var sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      var url = this.dataSource + sep + \"_=\" + (new Date()).getTime();\n      fetchDataSource(this, url);\n    } else if (typeof this.dataSource === \"function\") {\n      fetchDataSource(this, this.dataSource);\n    }\n  };\n\n  Chart.prototype.startRefresh = function startRefresh () {\n      var this$1 = this;\n\n    var refresh = this.options.refresh;\n\n    if (refresh && typeof this.dataSource !== \"string\" && typeof this.dataSource !== \"function\") {\n      throw new Error(\"Data source must be a URL or callback for refresh\");\n    }\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval( function () {\n          this$1.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  };\n\n  Chart.prototype.stopRefresh = function stopRefresh () {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  };\n\n  Chart.prototype.toImage = function toImage (download) {\n    if (this.adapter === \"chartjs\") {\n      if (download && download.background && download.background !== \"transparent\") {\n        // https://stackoverflow.com/questions/30464750/chartjs-line-chart-set-background-color\n        var canvas = this.chart.chart.canvas;\n        var ctx = this.chart.chart.ctx;\n        var tmpCanvas = document.createElement(\"canvas\");\n        var tmpCtx = tmpCanvas.getContext(\"2d\");\n        tmpCanvas.width = ctx.canvas.width;\n        tmpCanvas.height = ctx.canvas.height;\n        tmpCtx.fillStyle = download.background;\n        tmpCtx.fillRect(0, 0, tmpCanvas.width, tmpCanvas.height);\n        tmpCtx.drawImage(canvas, 0, 0);\n        return tmpCanvas.toDataURL(\"image/png\");\n      } else {\n        return this.chart.toBase64Image();\n      }\n    } else {\n      // TODO throw error in next major version\n      // throw new Error(\"Feature only available for Chart.js\");\n      return null;\n    }\n  };\n\n  Chart.prototype.destroy = function destroy () {\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  };\n\n  Chart.prototype.__updateOptions = function __updateOptions (options) {\n    var updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.__render = function __render () {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  };\n\n  Chart.prototype.__config = function __config () {\n    return config;\n  };\n\n  var LineChart = /*@__PURE__*/(function (Chart) {\n    function LineChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) LineChart.__proto__ = Chart;\n    LineChart.prototype = Object.create( Chart && Chart.prototype );\n    LineChart.prototype.constructor = LineChart;\n\n    LineChart.prototype.__processData = function __processData () {\n      return processSeries(this);\n    };\n\n    LineChart.prototype.__chartName = function __chartName () {\n      return \"LineChart\";\n    };\n\n    return LineChart;\n  }(Chart));\n\n  var PieChart = /*@__PURE__*/(function (Chart) {\n    function PieChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) PieChart.__proto__ = Chart;\n    PieChart.prototype = Object.create( Chart && Chart.prototype );\n    PieChart.prototype.constructor = PieChart;\n\n    PieChart.prototype.__processData = function __processData () {\n      return processSimple(this);\n    };\n\n    PieChart.prototype.__chartName = function __chartName () {\n      return \"PieChart\";\n    };\n\n    return PieChart;\n  }(Chart));\n\n  var ColumnChart = /*@__PURE__*/(function (Chart) {\n    function ColumnChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) ColumnChart.__proto__ = Chart;\n    ColumnChart.prototype = Object.create( Chart && Chart.prototype );\n    ColumnChart.prototype.constructor = ColumnChart;\n\n    ColumnChart.prototype.__processData = function __processData () {\n      return processSeries(this, null, true);\n    };\n\n    ColumnChart.prototype.__chartName = function __chartName () {\n      return \"ColumnChart\";\n    };\n\n    return ColumnChart;\n  }(Chart));\n\n  var BarChart = /*@__PURE__*/(function (Chart) {\n    function BarChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) BarChart.__proto__ = Chart;\n    BarChart.prototype = Object.create( Chart && Chart.prototype );\n    BarChart.prototype.constructor = BarChart;\n\n    BarChart.prototype.__processData = function __processData () {\n      return processSeries(this, null, true);\n    };\n\n    BarChart.prototype.__chartName = function __chartName () {\n      return \"BarChart\";\n    };\n\n    return BarChart;\n  }(Chart));\n\n  var AreaChart = /*@__PURE__*/(function (Chart) {\n    function AreaChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) AreaChart.__proto__ = Chart;\n    AreaChart.prototype = Object.create( Chart && Chart.prototype );\n    AreaChart.prototype.constructor = AreaChart;\n\n    AreaChart.prototype.__processData = function __processData () {\n      return processSeries(this);\n    };\n\n    AreaChart.prototype.__chartName = function __chartName () {\n      return \"AreaChart\";\n    };\n\n    return AreaChart;\n  }(Chart));\n\n  var GeoChart = /*@__PURE__*/(function (Chart) {\n    function GeoChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) GeoChart.__proto__ = Chart;\n    GeoChart.prototype = Object.create( Chart && Chart.prototype );\n    GeoChart.prototype.constructor = GeoChart;\n\n    GeoChart.prototype.__processData = function __processData () {\n      return processSimple(this);\n    };\n\n    GeoChart.prototype.__chartName = function __chartName () {\n      return \"GeoChart\";\n    };\n\n    return GeoChart;\n  }(Chart));\n\n  var ScatterChart = /*@__PURE__*/(function (Chart) {\n    function ScatterChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) ScatterChart.__proto__ = Chart;\n    ScatterChart.prototype = Object.create( Chart && Chart.prototype );\n    ScatterChart.prototype.constructor = ScatterChart;\n\n    ScatterChart.prototype.__processData = function __processData () {\n      return processSeries(this, \"number\");\n    };\n\n    ScatterChart.prototype.__chartName = function __chartName () {\n      return \"ScatterChart\";\n    };\n\n    return ScatterChart;\n  }(Chart));\n\n  var BubbleChart = /*@__PURE__*/(function (Chart) {\n    function BubbleChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) BubbleChart.__proto__ = Chart;\n    BubbleChart.prototype = Object.create( Chart && Chart.prototype );\n    BubbleChart.prototype.constructor = BubbleChart;\n\n    BubbleChart.prototype.__processData = function __processData () {\n      return processSeries(this, \"bubble\");\n    };\n\n    BubbleChart.prototype.__chartName = function __chartName () {\n      return \"BubbleChart\";\n    };\n\n    return BubbleChart;\n  }(Chart));\n\n  var Timeline = /*@__PURE__*/(function (Chart) {\n    function Timeline () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) Timeline.__proto__ = Chart;\n    Timeline.prototype = Object.create( Chart && Chart.prototype );\n    Timeline.prototype.constructor = Timeline;\n\n    Timeline.prototype.__processData = function __processData () {\n      var i, data = this.rawData;\n      for (i = 0; i < data.length; i++) {\n        data[i][1] = toDate(data[i][1]);\n        data[i][2] = toDate(data[i][2]);\n      }\n      return data;\n    };\n\n    Timeline.prototype.__chartName = function __chartName () {\n      return \"Timeline\";\n    };\n\n    return Timeline;\n  }(Chart));\n\n  var Chartkick = {\n    LineChart: LineChart,\n    PieChart: PieChart,\n    ColumnChart: ColumnChart,\n    BarChart: BarChart,\n    AreaChart: AreaChart,\n    GeoChart: GeoChart,\n    ScatterChart: ScatterChart,\n    BubbleChart: BubbleChart,\n    Timeline: Timeline,\n    charts: {},\n    configure: function (options) {\n      for (var key in options) {\n        if (options.hasOwnProperty(key)) {\n          config[key] = options[key];\n        }\n      }\n    },\n    setDefaultOptions: function (opts) {\n      Chartkick.options = opts;\n    },\n    eachChart: function (callback) {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          callback(Chartkick.charts[chartId]);\n        }\n      }\n    },\n    config: config,\n    options: {},\n    adapters: adapters,\n    addAdapter: addAdapter,\n    use: function(adapter) {\n      addAdapter(adapter);\n      return Chartkick;\n    }\n  };\n\n  // not ideal, but allows for simpler integration\n  if (typeof window !== \"undefined\" && !window.Chartkick) {\n    window.Chartkick = Chartkick;\n  }\n\n  // backwards compatibility for esm require\n  Chartkick.default = Chartkick;\n\n  return Chartkick;\n\n})));\n"]},"metadata":{},"sourceType":"script"}